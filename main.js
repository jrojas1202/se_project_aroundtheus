!function(){"use strict";class e{constructor(e,t){this._formElement=e,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_checkFormValidity=()=>this._inputElements.every((e=>e.validity.valid));_toggleButtonState(){this._checkFormValidity()?(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1):(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0)}_setEventListeners(){this._inputElements=[...this._formElement.querySelectorAll(this._inputSelector)],this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState(this._inputElements,this._submitButton)}))}))}resetValidation(){this._toggleButtonState(),this._inputElements.forEach((e=>{this._hideInputError(e)}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners(this._formElement)}}class t{constructor(e){let{data:t,cardSelector:s,handlePreviewImage:r,handleLikeCard:n,currentUserId:i,handleDeleteCard:o,owner:a}=e;this._name=t.name,this._link=t.link,this._isLiked=!!t.isLiked,console.log(t),this._id=t._id,this._cardSelector=s,this._handleImageClick=r,this._handleLikeCard=n,this._currentUserId=i,this._owner=t.owner._id,this._handleDeleteCard=o,console.log(this._owner)}_getTemplate(){return document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0)}deleteClick(){this._element.remove()}updateLikes(e){this._isLiked=e,this.renderLikes()}renderLikes(){this.isLiked()?this.likeButton.classList.add("card__like-button_active"):this.likeButton.classList.remove("card__like-button_active")}isLiked(){return this._isLiked}_checkIdForDelete(){this._owner===this._currentUserId?this.addTrash():this.removeTrash()}addTrash(){this.cardTrashButton.classList.remove("card__trash-button_active")}removeTrash(){this.cardTrashButton.classList.add("card__trash-button_active")}_setEventListeners(){this.likeButton.addEventListener("click",(()=>this._handleLikeCard(this.isLiked()))),this.cardTrashButton.addEventListener("click",(()=>{this._handleDeleteCard(this._id)})),this.cardImage.addEventListener("click",(()=>{this._handleImageClick()}))}generateCard(){this._element=this._getTemplate(),this.likeButton=this._element.querySelector(".card__like-button"),this.cardTrashButton=this._element.querySelector(".card__trash-button"),this.cardImage=this._element.querySelector(".card__image");const e=this._element.querySelector(".card__title");return this.cardImage.src=this._link,this.cardImage.alt=this._name,e.textContent=this._name,this._cardLikes=this._element.querySelector(".card__likes-counter"),this.renderLikes(),this._setEventListeners(),this._checkIdForDelete(),this._element}}class s{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__closebutton"))&&this.close()}))}}var r=class extends s{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".popup__form"),this._handleFormSubmit=t,this._modalSaveButton=this._popupElement.querySelector(".popup__button"),this._saveButtonText=this._modalSaveButton.textContent}_getInputValue(){const e=this._popupForm.querySelectorAll(".popup__input"),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(()=>this._handleFormSubmit(this._getInputValue())))}renderLoading(e){this._modalSaveButton.textContent=e?"Saving...":this._saveButtonText}close(){this._popupForm.reset(),super.close()}};class n{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}const i=document.querySelector("#modal"),o=document.querySelector(".profile__edit-button"),a=(i.querySelector("#modal-closebutton"),i.querySelector("#modal-form")),l=document.querySelector("#popup-name"),c=document.querySelector("#popup-description"),d=document.querySelector("#add-popup"),h=document.querySelector(".profile__add-button");console.log(d);const u=d.querySelector("#add-popupform"),_=(document.querySelector("#preview-popup").querySelector("#popup-closebutton"),document.querySelector("#avi-popupform")),p={inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},m=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:r}=e;this._nameEl=document.querySelector(t),this._jobEl=document.querySelector(s),this._avatarElement=document.querySelector(r)}getUserInfo(){return{name:this._nameEl.textContent,job:this._jobEl.textContent,avatar:this._avatarELement}}setAvatarInfo(e){this._avatarElement.src=e}setUserInfo(e){let{name:t,job:s}=e;this._nameEl.textContent=t,this._jobEl.textContent=s}}({nameSelector:".profile__title",jobSelector:".profile__description",avatarSelector:".profile__image"}),v=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error ${e.status}`)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then(this._checkResponse)}getAppInfo(){return Promise.all([this.getUserInfo(),this.initialCards()])}initialCards(){return fetch(`${this._baseUrl}/cards`,{method:"GET",headers:this._headers}).then(this._checkResponse)}editProfile(e){let{name:t,description:s}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})}).then(this._checkResponse)}addNewCard(e){let{name:t,link:s}=e;return fetch(`${this._baseUrl}/cards`,{method:"post",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then(this._checkResponse)}cardLikes(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}addLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers,body:JSON.stringify({isLiked:!0})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}removeLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}updateProfilePicture(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"92f7ebfa-9e8e-4fb8-b0a3-1cdaa15ccbe0","Content-Type":"application/json"}});let E,L;function b(e){const s=new t({data:e,cardSelector:"#card-template",currentUserId:L,handlePreviewImage:()=>{q.open(e)},handleLikeCard:t=>{t?v.removeLike(e._id).then((e=>{s.updateLikes(e.isLiked)})).catch((e=>{console.log(e)})):v.addLike(e._id).then((e=>{s.updateLikes(e.isLiked)})).catch((e=>{console.log(e)}))},handleDeleteCard:e=>{g.open(),g.setSubmitAction((()=>{g.renderLoading(!0),v.deleteCard(e).then((()=>{s.deleteClick(),g.close()})).catch((e=>{console.log(e)})).finally((()=>{g.renderLoading(!1)}))}))}});return s.generateCard()}v.getAppInfo().then((e=>{let[t,s]=e;L=t._id,m.setUserInfo({name:t.name,job:t.about}),m.setAvatarInfo(t.avatar),E=new n({items:s,renderer:e=>{const t=b(e);E.addItem(t)}},".cards__list"),E.renderItems()})).catch((e=>{console.log(e)}));const S=new e(u,p);S.enableValidation(),console.log(u);const k=new e(a,p);k.enableValidation();const f=new e(_,p);f.enableValidation();const g=new class extends s{constructor(e){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".popup__form"),this._confirmButton=document.querySelector("#delete__button"),this._saveButton=document.querySelector(".popup__button")}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleDeleteSubmit()}))}renderLoading(e){this._confirmButton.textContent=e?"Saving...":"yes"}setSubmitAction(e){this._handleDeleteSubmit=e}}("#delete-popup");g.setEventListeners();const y=new r("#modal",(e=>{y.renderLoading(!0),v.editProfile(e).then((()=>{m.setUserInfo({name:e.name,job:e.description}),y.close()})).catch((e=>{console.log(e)})).finally((()=>{y.renderLoading(!1)}))}));y.setEventListeners();const C=new r("#add-popup",(e=>{C.renderLoading(!0),v.addNewCard(e).then((e=>{const t=b(e);E.addItem(t),C.close()})).catch((e=>{console.log(e)})).finally((()=>{C.renderLoading(!1)}))}));C.setEventListeners();const I=new r("#avi-popup",(e=>{I.renderLoading(!0),v.updateProfilePicture(e).then((e=>{m.setAvatarInfo(e.avatar),I.close()})).catch((e=>{console.log(e)})).finally((()=>{I.renderLoading(!1)}))}));I.setEventListeners(),document.querySelector(".profile__image").addEventListener("click",(()=>{I.open(),f.resetValidation()}));const q=new class extends s{constructor(e){super({popupSelector:e}),this._image=document.querySelector("#popup-image"),this._text=document.querySelector("#popup-text")}open(e){let{link:t,name:s}=e;this._image.src=t,this._image.alt=s,this._text.textContent=s,super.open()}}("#preview-popup");q.setEventListeners(),o.addEventListener("click",(function(){const{name:e,job:t}=m.getUserInfo();l.value=e,c.value=t,k.resetValidation(),y.open()})),h.addEventListener("click",(()=>{S.resetValidation(),C.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy91dGlscy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwQ29uZmlybWF0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKGZvcm1FbGVtZW50LCBjb25maWcpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gY29uZmlnLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IGNvbmZpZy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gY29uZmlnLmVycm9yQ2xhc3M7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2NoZWNrRm9ybVZhbGlkaXR5ID0gKCkgPT5cclxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZXZlcnkoKGlucHV0KSA9PiBpbnB1dC52YWxpZGl0eS52YWxpZCk7XHJcblxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGNvbnN0IHZhbGlkID0gdGhpcy5fY2hlY2tGb3JtVmFsaWRpdHkoKTtcclxuICAgIGlmICh2YWxpZCkge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvL1xyXG4gICAgLy8gY29uc3QgaXNWYWxpZCA9IHRoaXMuaW5wdXRFbGVtZW50cy5zb21lKChpbnB1dEVsZW1lbnQpPT4ge1xyXG4gICAgLy8gICAgIHJldHVybiBpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWRcclxuICAgIC8vIH0pXHJcbiAgICAvLyBpZiAoaXNWYWxpZCkge1xyXG4gICAgLy8gICAgIHN1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgLy8gICAgIHN1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAvLyAgIH0gZWxzZSB7XHJcbiAgICAvLyAgICAgc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAvLyAgICAgc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAvLyAgIH1cclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMgPSBbXHJcbiAgICAgIC4uLnRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvciksXHJcbiAgICBdO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcclxuICAgICk7XHJcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSh0aGlzLl9pbnB1dEVsZW1lbnRzLCB0aGlzLl9zdWJtaXRCdXR0b24pO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKHRoaXMuX2Zvcm1FbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3Ioe1xyXG4gICAgZGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIGhhbmRsZVByZXZpZXdJbWFnZSxcclxuICAgIGhhbmRsZUxpa2VDYXJkLFxyXG4gICAgY3VycmVudFVzZXJJZCxcclxuICAgIGhhbmRsZURlbGV0ZUNhcmQsXHJcbiAgICBvd25lcixcclxuICB9KSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2lzTGlrZWQgPSAhIWRhdGEuaXNMaWtlZDtcclxuICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcclxuXHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlUHJldmlld0ltYWdlO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZUNhcmQgPSBoYW5kbGVMaWtlQ2FyZDtcclxuICAgIHRoaXMuX2N1cnJlbnRVc2VySWQgPSBjdXJyZW50VXNlcklkO1xyXG4gICAgdGhpcy5fb3duZXIgPSBkYXRhLm93bmVyLl9pZDtcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQgPSBoYW5kbGVEZWxldGVDYXJkO1xyXG4gICAgY29uc29sZS5sb2codGhpcy5fb3duZXIpO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkLmNsb25lTm9kZSh0cnVlKTtcclxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNsaWNrKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUxpa2VzKGlzTGlrZWQpIHtcclxuICAgIHRoaXMuX2lzTGlrZWQgPSBpc0xpa2VkO1xyXG4gICAgdGhpcy5yZW5kZXJMaWtlcygpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyTGlrZXMoKSB7XHJcbiAgICAvLyB0aGlzLl9jYXJkTGlrZXMudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XHJcbiAgICBjb25zdCBpc0xpa2VkID0gdGhpcy5pc0xpa2VkKCk7XHJcbiAgICBpZiAoaXNMaWtlZCkge1xyXG4gICAgICB0aGlzLmxpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMubGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgaXNMaWtlZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pc0xpa2VkO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSWRGb3JEZWxldGUoKSB7XHJcbiAgICBpZiAodGhpcy5fb3duZXIgPT09IHRoaXMuX2N1cnJlbnRVc2VySWQpIHtcclxuICAgICAgdGhpcy5hZGRUcmFzaCgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5yZW1vdmVUcmFzaCgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYWRkVHJhc2goKSB7XHJcbiAgICB0aGlzLmNhcmRUcmFzaEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fdHJhc2gtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICB9XHJcblxyXG4gIHJlbW92ZVRyYXNoKCkge1xyXG4gICAgdGhpcy5jYXJkVHJhc2hCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX3RyYXNoLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLmxpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDYXJkKHRoaXMuaXNMaWtlZCgpKVxyXG4gICAgKTtcclxuICAgIHRoaXMuY2FyZFRyYXNoQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQodGhpcy5faWQpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLmNhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5jYXJkVHJhc2hCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdHJhc2gtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5jYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICBjb25zdCBjYXJkVGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcbiAgICB0aGlzLmNhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcclxuICAgIGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9jYXJkTGlrZXMgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZXMtY291bnRlclwiKTtcclxuICAgIHRoaXMucmVuZGVyTGlrZXMoKTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9jaGVja0lkRm9yRGVsZXRlKCk7XHJcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cFwiKSB8fFxyXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfX2Nsb3NlYnV0dG9uXCIpXHJcbiAgICAgICkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5jbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9tb2RhbFNhdmVCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fc2F2ZUJ1dHRvblRleHQgPSB0aGlzLl9tb2RhbFNhdmVCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZSgpIHtcclxuICAgIGNvbnN0IGlucHV0cyA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19pbnB1dFwiKTtcclxuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XHJcbiAgICBpbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlKCkpXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcpIHtcclxuICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fbW9kYWxTYXZlQnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX21vZGFsU2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3NhdmVCdXR0b25UZXh0O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhGb3JtO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBzZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3lvc2VtaXRlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQmFsZCBtb3VudGFpbnNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGF0ZW1hci5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3Zhbm9pc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhZ28uanBnXCIsXHJcbiAgfSxcclxuXTtcclxuXHJcbmNvbnN0IHByb2ZpbGVNb2RhbEJveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWxcIik7XHJcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcclxuY29uc3QgcHJvZmlsZU1vZGFsQ2xvc2VCdXR0b24gPVxyXG4gIHByb2ZpbGVNb2RhbEJveC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWNsb3NlYnV0dG9uXCIpO1xyXG5jb25zdCBwcm9maWxlRWRpdEZvcm0gPSBwcm9maWxlTW9kYWxCb3gucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1mb3JtXCIpO1xyXG5jb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXAtbmFtZVwiKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwLWRlc2NyaXB0aW9uXCIpO1xyXG5jb25zdCBhZGRNb2RhbEJveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLXBvcHVwXCIpO1xyXG5jb25zdCBhZGRNb2RhbEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuY29uc29sZS5sb2coYWRkTW9kYWxCb3gpO1xyXG5jb25zdCBhZGRNb2RhbEZvcm0gPSBhZGRNb2RhbEJveC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1wb3B1cGZvcm1cIik7XHJcbmNvbnN0IGltYWdlTW9kYWxXaW5kb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctcG9wdXBcIik7XHJcbmNvbnN0IGltYWdlQ2xvc2VCdXR0b24gPSBpbWFnZU1vZGFsV2luZG93LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXAtY2xvc2VidXR0b25cIik7XHJcbmNvbnN0IGF2aUZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2aS1wb3B1cGZvcm1cIik7XHJcblxyXG5jb25zdCBmb3JtVmFsaWRhdGlvbkNvbmZpZyA9IHtcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX2J1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwicG9wdXBfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuZXhwb3J0IGZ1bmN0aW9uIGhhbmRsZU92ZXJsYXlDbG9zZShldnQpIHtcclxuICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cFwiKSkge1xyXG4gICAgY2xvc2VNb2RhbChldnQudGFyZ2V0KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBoYW5kbGVFc2NVcChldnQpIHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgY29uc3Qgb3BlblBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9vcGVuZWRcIik7XHJcbiAgICBjbG9zZU1vZGFsKG9wZW5Qb3B1cCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gb3Blbk1vZGFsKG1vZGFsKSB7XHJcbiAgbW9kYWwuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5lZFwiKTtcclxuICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGhhbmRsZU92ZXJsYXlDbG9zZSk7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGhhbmRsZUVzY1VwKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gIG1vZGFsLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgaGFuZGxlT3ZlcmxheUNsb3NlKTtcclxuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgaGFuZGxlRXNjVXApO1xyXG59XHJcblxyXG5leHBvcnQge1xyXG4gIGZvcm1WYWxpZGF0aW9uQ29uZmlnLFxyXG4gIGltYWdlQ2xvc2VCdXR0b24sXHJcbiAgaW1hZ2VNb2RhbFdpbmRvdyxcclxuICBhZGRNb2RhbEZvcm0sXHJcbiAgYWRkTW9kYWxCdXR0b24sXHJcbiAgYWRkTW9kYWxCb3gsXHJcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQsXHJcbiAgcHJvZmlsZVRpdGxlSW5wdXQsXHJcbiAgcHJvZmlsZUVkaXRGb3JtLFxyXG4gIHByb2ZpbGVNb2RhbENsb3NlQnV0dG9uLFxyXG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxyXG4gIHByb2ZpbGVNb2RhbEJveCxcclxuICBhdmlGb3JtLFxyXG59O1xyXG4iLCJpbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IFBvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBDb25maXJtYXRpb24uanNcIjtcclxuaW1wb3J0IHtcclxuICBmb3JtVmFsaWRhdGlvbkNvbmZpZyxcclxuICBpbWFnZUNsb3NlQnV0dG9uLFxyXG4gIGltYWdlTW9kYWxXaW5kb3csXHJcbiAgYWRkTW9kYWxGb3JtLFxyXG4gIGFkZE1vZGFsQnV0dG9uLFxyXG4gIGFkZE1vZGFsQm94LFxyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LFxyXG4gIHByb2ZpbGVUaXRsZUlucHV0LFxyXG4gIHByb2ZpbGVFZGl0Rm9ybSxcclxuICBwcm9maWxlTW9kYWxDbG9zZUJ1dHRvbixcclxuICBwcm9maWxlRWRpdEJ1dHRvbixcclxuICBwcm9maWxlTW9kYWxCb3gsXHJcbiAgYXZpRm9ybSxcclxufSBmcm9tIFwiLi4vdXRpbHMvdXRpbHMuanNcIjtcclxuXHJcbmNvbnN0IHVzZXJJbmZvRWwgPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fdGl0bGVcIixcclxuICBqb2JTZWxlY3RvcjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcclxuICBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9faW1hZ2VcIixcclxufSk7XHJcblxyXG4vKi0tLS0tLS0tLS0gQVBJIC0tLS0tLS0tLS0qL1xyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCI5MmY3ZWJmYS05ZThlLTRmYjgtYjBhMy0xY2RhYTE1Y2NiZTBcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5sZXQgc2VjdGlvbkVsO1xyXG5sZXQgY3VycmVudFVzZXJJZDtcclxuYXBpXHJcbiAgLmdldEFwcEluZm8oKVxyXG4gIC50aGVuKChbdXNlckRhdGEsIGNhcmREYXRhXSkgPT4ge1xyXG4gICAgY3VycmVudFVzZXJJZCA9IHVzZXJEYXRhLl9pZDtcclxuICAgIHVzZXJJbmZvRWwuc2V0VXNlckluZm8oeyBuYW1lOiB1c2VyRGF0YS5uYW1lLCBqb2I6IHVzZXJEYXRhLmFib3V0IH0pO1xyXG4gICAgdXNlckluZm9FbC5zZXRBdmF0YXJJbmZvKHVzZXJEYXRhLmF2YXRhcik7XHJcblxyXG4gICAgc2VjdGlvbkVsID0gbmV3IFNlY3Rpb24oXHJcbiAgICAgIHtcclxuICAgICAgICBpdGVtczogY2FyZERhdGEsXHJcblxyXG4gICAgICAgIHJlbmRlcmVyOiAoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgY2FyZCA9IGNyZWF0ZUNhcmQoZGF0YSk7XHJcbiAgICAgICAgICBzZWN0aW9uRWwuYWRkSXRlbShjYXJkKTtcclxuICAgICAgICB9LFxyXG4gICAgICB9LFxyXG4gICAgICBcIi5jYXJkc19fbGlzdFwiXHJcbiAgICApO1xyXG4gICAgc2VjdGlvbkVsLnJlbmRlckl0ZW1zKCk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5sb2coZXJyKTtcclxuICB9KTtcclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoZGF0YSkge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZCh7XHJcbiAgICBkYXRhLFxyXG4gICAgY2FyZFNlbGVjdG9yOiBcIiNjYXJkLXRlbXBsYXRlXCIsXHJcbiAgICBjdXJyZW50VXNlcklkLFxyXG4gICAgaGFuZGxlUHJldmlld0ltYWdlOiAoKSA9PiB7XHJcbiAgICAgIGltYWdlUG9wdXAub3BlbihkYXRhKTtcclxuICAgIH0sXHJcbiAgICBoYW5kbGVMaWtlQ2FyZDogKHNob3VsZFJlbW92ZUxpa2UpID0+IHtcclxuICAgICAgaWYgKHNob3VsZFJlbW92ZUxpa2UpIHtcclxuICAgICAgICBhcGlcclxuICAgICAgICAgIC5yZW1vdmVMaWtlKGRhdGEuX2lkKVxyXG4gICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgY2FyZC51cGRhdGVMaWtlcyhkYXRhLmlzTGlrZWQpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBhcGlcclxuICAgICAgICAgIC5hZGRMaWtlKGRhdGEuX2lkKVxyXG4gICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgY2FyZC51cGRhdGVMaWtlcyhkYXRhLmlzTGlrZWQpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIGhhbmRsZURlbGV0ZUNhcmQ6IChjYXJkSWQpID0+IHtcclxuICAgICAgZGVsZXRlUG9wdXAub3BlbigpO1xyXG4gICAgICBkZWxldGVQb3B1cC5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xyXG4gICAgICAgIGRlbGV0ZVBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgICAgICAgYXBpXHJcbiAgICAgICAgICAuZGVsZXRlQ2FyZChjYXJkSWQpXHJcbiAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIGNhcmQuZGVsZXRlQ2xpY2soKTtcclxuICAgICAgICAgICAgZGVsZXRlUG9wdXAuY2xvc2UoKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICAgICAgZGVsZXRlUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9LFxyXG4gIH0pO1xyXG4gIHJldHVybiBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xyXG59XHJcblxyXG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoYWRkTW9kYWxGb3JtLCBmb3JtVmFsaWRhdGlvbkNvbmZpZyk7XHJcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5jb25zb2xlLmxvZyhhZGRNb2RhbEZvcm0pO1xyXG5cclxuY29uc3QgcHJvZmlsZUZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICBwcm9maWxlRWRpdEZvcm0sXHJcbiAgZm9ybVZhbGlkYXRpb25Db25maWdcclxuKTtcclxucHJvZmlsZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgYXZpRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGF2aUZvcm0sIGZvcm1WYWxpZGF0aW9uQ29uZmlnKTtcclxuYXZpRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5jb25zdCBkZWxldGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oXCIjZGVsZXRlLXBvcHVwXCIpO1xyXG5kZWxldGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgZWRpdEZvcm1Nb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI21vZGFsXCIsIChpbnB1dFZhbHVlcykgPT4ge1xyXG4gIGVkaXRGb3JtTW9kYWwucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuICBhcGlcclxuICAgIC5lZGl0UHJvZmlsZShpbnB1dFZhbHVlcylcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgdXNlckluZm9FbC5zZXRVc2VySW5mbyh7XHJcbiAgICAgICAgbmFtZTogaW5wdXRWYWx1ZXMubmFtZSxcclxuICAgICAgICBqb2I6IGlucHV0VmFsdWVzLmRlc2NyaXB0aW9uLFxyXG4gICAgICB9KTtcclxuICAgICAgZWRpdEZvcm1Nb2RhbC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBlZGl0Rm9ybU1vZGFsLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG5lZGl0Rm9ybU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBhZGRGb3JtTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNhZGQtcG9wdXBcIiwgKGlucHV0VmFsdWVzKSA9PiB7XHJcbiAgYWRkRm9ybU1vZGFsLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAuYWRkTmV3Q2FyZChpbnB1dFZhbHVlcylcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmQgPSBjcmVhdGVDYXJkKGRhdGEpO1xyXG4gICAgICBzZWN0aW9uRWwuYWRkSXRlbShjYXJkKTtcclxuICAgICAgYWRkRm9ybU1vZGFsLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGFkZEZvcm1Nb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59KTtcclxuYWRkRm9ybU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCB1cGRhdGVQcm9maWxlRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI2F2aS1wb3B1cFwiLCAoaW5wdXRWYWx1ZXMpID0+IHtcclxuICB1cGRhdGVQcm9maWxlRm9ybS5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLnVwZGF0ZVByb2ZpbGVQaWN0dXJlKGlucHV0VmFsdWVzKVxyXG4gICAgLnRoZW4oKHZhbHVlKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvRWwuc2V0QXZhdGFySW5mbyh2YWx1ZS5hdmF0YXIpO1xyXG4gICAgICB1cGRhdGVQcm9maWxlRm9ybS5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICB1cGRhdGVQcm9maWxlRm9ybS5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59KTtcclxudXBkYXRlUHJvZmlsZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVFZGl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZVwiKTtcclxucHJvZmlsZUVkaXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICB1cGRhdGVQcm9maWxlRm9ybS5vcGVuKCk7XHJcbiAgYXZpRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxufSk7XHJcblxyXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI3ByZXZpZXctcG9wdXBcIik7XHJcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmZ1bmN0aW9uIG9wZW5Qcm9maWxlTW9kYWwoKSB7XHJcbiAgY29uc3QgeyBuYW1lLCBqb2IgfSA9IHVzZXJJbmZvRWwuZ2V0VXNlckluZm8oKTtcclxuICBwcm9maWxlVGl0bGVJbnB1dC52YWx1ZSA9IG5hbWU7XHJcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBqb2I7XHJcbiAgcHJvZmlsZUZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgZWRpdEZvcm1Nb2RhbC5vcGVuKCk7XHJcbn1cclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5Qcm9maWxlTW9kYWwpO1xyXG5hZGRNb2RhbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGFkZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgYWRkRm9ybU1vZGFsLm9wZW4oKTtcclxufSk7XHJcblxyXG5mdW5jdGlvbiBjbG9zZVByb2ZpbGVNb2RhbCgpIHtcclxuICBlZGl0Rm9ybU1vZGFsLmNsb3NlKCk7XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xyXG4gICAgdGhpcy5fbmFtZUVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fam9iRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYlNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fbmFtZUVsLnRleHRDb250ZW50LFxyXG4gICAgICBqb2I6IHRoaXMuX2pvYkVsLnRleHRDb250ZW50LFxyXG4gICAgICBhdmF0YXI6IHRoaXMuX2F2YXRhckVMZW1lbnQsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc2V0QXZhdGFySW5mbyhhdmF0YXIpIHtcclxuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjID0gYXZhdGFyO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oeyBuYW1lLCBqb2IgfSkge1xyXG4gICAgdGhpcy5fbmFtZUVsLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX2pvYkVsLnRleHRDb250ZW50ID0gam9iO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvciAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGdldEFwcEluZm8oKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0VXNlckluZm8oKSwgdGhpcy5pbml0aWFsQ2FyZHMoKV0pO1xyXG4gIH1cclxuXHJcbiAgaW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZWRpdFByb2ZpbGUoeyBuYW1lLCBkZXNjcmlwdGlvbiB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICBhYm91dDogZGVzY3JpcHRpb24sXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGFkZE5ld0NhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcInBvc3RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgY2FyZExpa2VzKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoY2FyZElEKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSUR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgYWRkTGlrZShjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGlzTGlrZWQ6IHRydWUsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlTGlrZShjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbiAgdXBkYXRlUHJvZmlsZVBpY3R1cmUoYXZhdGFyKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYXZhdGFyKSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICAvLyBvdGhlciBtZXRob2RzIGZvciB3b3JraW5nIHdpdGggdGhlIEFQSVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xyXG4gICAgdGhpcy5fY29uZmlybUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlX19idXR0b25cIik7XHJcbiAgICB0aGlzLl9zYXZlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fYnV0dG9uXCIpO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlU3VibWl0KCk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcpIHtcclxuICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fY29uZmlybUJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9jb25maXJtQnV0dG9uLnRleHRDb250ZW50ID0gXCJ5ZXNcIjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldFN1Ym1pdEFjdGlvbihhY3Rpb24pIHtcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZVN1Ym1pdCA9IGFjdGlvbjtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9pbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXAtaW1hZ2VcIik7XHJcbiAgICB0aGlzLl90ZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwb3B1cC10ZXh0XCIpO1xyXG4gIH1cclxuXHJcbiAgb3Blbih7IGxpbmssIG5hbWUgfSkge1xyXG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gbGluaztcclxuICAgIHRoaXMuX2ltYWdlLmFsdCA9IG5hbWU7XHJcbiAgICB0aGlzLl90ZXh0LnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkZvcm1WYWxpZGF0b3IiLCJjb25zdHJ1Y3RvciIsImZvcm1FbGVtZW50IiwiY29uZmlnIiwidGhpcyIsIl9mb3JtRWxlbWVudCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZUVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiaWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJ0ZXh0Q29udGVudCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwicmVtb3ZlIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJfY2hlY2tGb3JtVmFsaWRpdHkiLCJfaW5wdXRFbGVtZW50cyIsImV2ZXJ5IiwiaW5wdXQiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZXNldFZhbGlkYXRpb24iLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJDYXJkIiwiX3JlZiIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVQcmV2aWV3SW1hZ2UiLCJoYW5kbGVMaWtlQ2FyZCIsImN1cnJlbnRVc2VySWQiLCJoYW5kbGVEZWxldGVDYXJkIiwib3duZXIiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfaXNMaWtlZCIsImlzTGlrZWQiLCJjb25zb2xlIiwibG9nIiwiX2lkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZUxpa2VDYXJkIiwiX2N1cnJlbnRVc2VySWQiLCJfb3duZXIiLCJfaGFuZGxlRGVsZXRlQ2FyZCIsIl9nZXRUZW1wbGF0ZSIsImRvY3VtZW50IiwiY29udGVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiY2xvbmVOb2RlIiwiZGVsZXRlQ2xpY2siLCJfZWxlbWVudCIsInVwZGF0ZUxpa2VzIiwicmVuZGVyTGlrZXMiLCJsaWtlQnV0dG9uIiwiX2NoZWNrSWRGb3JEZWxldGUiLCJhZGRUcmFzaCIsInJlbW92ZVRyYXNoIiwiY2FyZFRyYXNoQnV0dG9uIiwiY2FyZEltYWdlIiwiZ2VuZXJhdGVDYXJkIiwiY2FyZFRpdGxlIiwic3JjIiwiYWx0IiwiX2NhcmRMaWtlcyIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwib3BlbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfbW9kYWxTYXZlQnV0dG9uIiwiX3NhdmVCdXR0b25UZXh0IiwiX2dldElucHV0VmFsdWUiLCJpbnB1dHMiLCJpbnB1dFZhbHVlcyIsInZhbHVlIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsInJlc2V0IiwiU2VjdGlvbiIsInNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJwcm9maWxlTW9kYWxCb3giLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVFZGl0Rm9ybSIsInByb2ZpbGVUaXRsZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJhZGRNb2RhbEJveCIsImFkZE1vZGFsQnV0dG9uIiwiYWRkTW9kYWxGb3JtIiwiYXZpRm9ybSIsImZvcm1WYWxpZGF0aW9uQ29uZmlnIiwidXNlckluZm9FbCIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfbmFtZUVsIiwiX2pvYkVsIiwiX2F2YXRhckVsZW1lbnQiLCJnZXRVc2VySW5mbyIsImpvYiIsImF2YXRhciIsIl9hdmF0YXJFTGVtZW50Iiwic2V0QXZhdGFySW5mbyIsInNldFVzZXJJbmZvIiwiX3JlZjIiLCJhcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJmZXRjaCIsIm1ldGhvZCIsInRoZW4iLCJnZXRBcHBJbmZvIiwiYWxsIiwiaW5pdGlhbENhcmRzIiwiZWRpdFByb2ZpbGUiLCJkZXNjcmlwdGlvbiIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJhZGROZXdDYXJkIiwiX3JlZjMiLCJjYXJkTGlrZXMiLCJjYXJkSWQiLCJkZWxldGVDYXJkIiwiY2FyZElEIiwiYWRkTGlrZSIsInJlbW92ZUxpa2UiLCJ1cGRhdGVQcm9maWxlUGljdHVyZSIsImF1dGhvcml6YXRpb24iLCJzZWN0aW9uRWwiLCJjcmVhdGVDYXJkIiwiY2FyZCIsImltYWdlUG9wdXAiLCJzaG91bGRSZW1vdmVMaWtlIiwiY2F0Y2giLCJlcnIiLCJkZWxldGVQb3B1cCIsInNldFN1Ym1pdEFjdGlvbiIsImZpbmFsbHkiLCJ1c2VyRGF0YSIsImNhcmREYXRhIiwiYWRkRm9ybVZhbGlkYXRvciIsInByb2ZpbGVGb3JtVmFsaWRhdG9yIiwiYXZpRm9ybVZhbGlkYXRvciIsIl9jb25maXJtQnV0dG9uIiwiX3NhdmVCdXR0b24iLCJfaGFuZGxlRGVsZXRlU3VibWl0IiwiYWN0aW9uIiwiZWRpdEZvcm1Nb2RhbCIsIlBvcHVwV2l0aEZvcm0iLCJhZGRGb3JtTW9kYWwiLCJ1cGRhdGVQcm9maWxlRm9ybSIsIl9pbWFnZSIsIl90ZXh0Il0sInNvdXJjZVJvb3QiOiIifQ==