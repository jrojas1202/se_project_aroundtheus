!function(){"use strict";class e{constructor(e,t){this._formElement=e,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_checkFormValidity=()=>this._inputElements.every((e=>e.validity.valid));_toggleButtonState(){this._checkFormValidity()?(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1):(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0)}_setEventListeners(){this._inputElements=[...this._formElement.querySelectorAll(this._inputSelector)],this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState(this._inputElements,this._submitButton)}))}))}resetValidation(){this._toggleButtonState(),this._inputElements.forEach((e=>{this._hideInputError(e)}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners(this._formElement)}}class t{constructor(e){let{data:t,cardSelector:s,handlePreviewImage:r,handleLikeCard:n,currentUserId:i,handleDeleteCard:o,owner:a}=e;this._name=t.name,this._link=t.link,this._isLiked=!!t.isLiked,this._id=t._id,this._cardSelector=s,this._handleImageClick=r,this._handleLikeCard=n,this._currentUserId=i,this._owner=t.owner._id,this._handleDeleteCard=o,console.log(this._owner)}_getTemplate(){return document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0)}deleteClick(){this._element.remove()}updateLikes(e){this._isLiked=e,this.renderLikes()}renderLikes(){this.isLiked()?this.likeButton.classList.add("card__like-button_active"):this.likeButton.classList.remove("card__like-button_active")}isLiked(){return this._isLiked}_checkIdForDelete(){this._owner===this._currentUserId?this.addTrash():this.removeTrash()}addTrash(){this.cardTrashButton.classList.remove("card__trash-button_active")}removeTrash(){this.cardTrashButton.classList.add("card__trash-button_active")}_setEventListeners(){this.likeButton.addEventListener("click",(()=>this._handleLikeCard(this.isLiked()))),this.cardTrashButton.addEventListener("click",(()=>{this._handleDeleteCard(this._id)})),this.cardImage.addEventListener("click",(()=>{this._handleImageClick()}))}generateCard(){this._element=this._getTemplate(),this.likeButton=this._element.querySelector(".card__like-button"),this.cardTrashButton=this._element.querySelector(".card__trash-button"),this.cardImage=this._element.querySelector(".card__image");const e=this._element.querySelector(".card__title");return this.cardImage.src=this._link,this.cardImage.alt=this._name,e.textContent=this._name,this._cardLikes=this._element.querySelector(".card__likes-counter"),this.renderLikes(),this._setEventListeners(),this._checkIdForDelete(),this._element}}class s{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__closebutton"))&&this.close()}))}}var r=class extends s{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".popup__form"),this._handleFormSubmit=t,this._modalSaveButton=this._popupElement.querySelector(".popup__button"),this._saveButtonText=this._modalSaveButton.textContent}_getInputValue(){const e=this._popupForm.querySelectorAll(".popup__input"),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(()=>this._handleFormSubmit(this._getInputValue())))}renderLoading(e){this._modalSaveButton.textContent=e?"Saving...":this._saveButtonText}close(){this._popupForm.reset(),super.close()}};class n{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}const i=document.querySelector("#modal"),o=document.querySelector(".profile__edit-button"),a=(i.querySelector("#modal-closebutton"),i.querySelector("#modal-form")),l=document.querySelector("#popup-name"),c=document.querySelector("#popup-description"),d=document.querySelector("#add-popup"),h=document.querySelector(".profile__add-button"),u=d.querySelector("#add-popupform"),_=(document.querySelector("#preview-popup").querySelector("#popup-closebutton"),document.querySelector("#avi-popupform")),p={inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},m=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:r}=e;this._nameEl=document.querySelector(t),this._jobEl=document.querySelector(s),this._avatarElement=document.querySelector(r)}getUserInfo(){return{name:this._nameEl.textContent,job:this._jobEl.textContent,avatar:this._avatarELement}}setAvatarInfo(e){this._avatarElement.src=e}setUserInfo(e){let{name:t,job:s}=e;this._nameEl.textContent=t,this._jobEl.textContent=s}}({nameSelector:".profile__title",jobSelector:".profile__description",avatarSelector:".profile__image"}),v=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error ${e.status}`)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then(this._checkResponse)}getAppInfo(){return Promise.all([this.getUserInfo(),this.initialCards()])}initialCards(){return fetch(`${this._baseUrl}/cards`,{method:"GET",headers:this._headers}).then(this._checkResponse)}editProfile(e){let{name:t,description:s}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})}).then(this._checkResponse)}addNewCard(e){let{name:t,link:s}=e;return fetch(`${this._baseUrl}/cards`,{method:"post",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then(this._checkResponse)}cardLikes(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}addLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers,body:JSON.stringify({isLiked:!0})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}removeLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}updateProfilePicture(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"92f7ebfa-9e8e-4fb8-b0a3-1cdaa15ccbe0","Content-Type":"application/json"}});let E,L;function b(e){const s=new t({data:e,cardSelector:"#card-template",currentUserId:L,handlePreviewImage:()=>{q.open(e)},handleLikeCard:t=>{t?v.removeLike(e._id).then((e=>{s.updateLikes(e.isLiked)})).catch((e=>{console.log(e)})):v.addLike(e._id).then((e=>{s.updateLikes(e.isLiked)})).catch((e=>{console.log(e)}))},handleDeleteCard:e=>{y.open(),y.setSubmitAction((()=>{y.renderLoading(!0),v.deleteCard(e).then((()=>{s.deleteClick(),y.close()})).catch((e=>{console.log(e)})).finally((()=>{y.renderLoading(!1)}))}))}});return s.generateCard()}v.getAppInfo().then((e=>{let[t,s]=e;L=t._id,m.setUserInfo({name:t.name,job:t.about}),m.setAvatarInfo(t.avatar),E=new n({items:s,renderer:e=>{const t=b(e);E.addItem(t)}},".cards__list"),E.renderItems()})).catch((e=>{console.log(e)}));const S=new e(u,p);S.enableValidation();const k=new e(a,p);k.enableValidation();const f=new e(_,p);f.enableValidation();const y=new class extends s{constructor(e){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".popup__form"),this._confirmButton=document.querySelector("#delete__button"),this._saveButton=document.querySelector(".popup__button")}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleDeleteSubmit()}))}renderLoading(e){this._confirmButton.textContent=e?"Saving...":"yes"}setSubmitAction(e){this._handleDeleteSubmit=e}}("#delete-popup");y.setEventListeners();const g=new r("#modal",(e=>{g.renderLoading(!0),v.editProfile(e).then((()=>{m.setUserInfo({name:e.name,job:e.description}),g.close()})).catch((e=>{console.log(e)})).finally((()=>{g.renderLoading(!1)}))}));g.setEventListeners();const C=new r("#add-popup",(e=>{C.renderLoading(!0),v.addNewCard(e).then((e=>{const t=b(e);E.addItem(t),C.close()})).catch((e=>{console.log(e)})).finally((()=>{C.renderLoading(!1)}))}));C.setEventListeners();const I=new r("#avi-popup",(e=>{I.renderLoading(!0),v.updateProfilePicture(e).then((e=>{m.setAvatarInfo(e.avatar),I.close()})).catch((e=>{console.log(e)})).finally((()=>{I.renderLoading(!1)}))}));I.setEventListeners(),document.querySelector(".profile__image").addEventListener("click",(()=>{I.open(),f.resetValidation()}));const q=new class extends s{constructor(e){super({popupSelector:e}),this._image=document.querySelector("#popup-image"),this._text=document.querySelector("#popup-text")}open(e){let{link:t,name:s}=e;this._image.src=t,this._image.alt=s,this._text.textContent=s,super.open()}}("#preview-popup");q.setEventListeners(),o.addEventListener("click",(function(){const{name:e,job:t}=m.getUserInfo();l.value=e,c.value=t,k.resetValidation(),g.open()})),h.addEventListener("click",(()=>{S.resetValidation(),C.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YyxHQUNoQ3VDLEVBQ0dnQyxxQkFBcUJ6RSxHQUNyQnVELE1BQU10RCxJQUNMMEIsRUFBV1csY0FBY3JDLEVBQU1tQyxRQUMvQjZELEVBQWtCL0csT0FBTyxJQUUxQjhGLE9BQU9DLElBQ04zSCxRQUFRQyxJQUFJMEgsRUFBSSxJQUVqQkcsU0FBUSxLQUNQYSxFQUFrQi9GLGVBQWMsRUFBTSxHQUN0QyxJQUVOK0YsRUFBa0I1RyxvQkFFRTVCLFNBQVNuRCxjQUFjLG1CQUMvQnFCLGlCQUFpQixTQUFTLEtBQ3BDc0ssRUFBa0JoSCxPQUNsQndHLEVBQWlCN0osaUJBQWlCLElBR3BDLE1BQU1rSixFQUFhLElJL0xKLGNBQTZCbEcsRUFDMUN4RixXQUFBQSxDQUFZeUYsR0FDVlksTUFBTSxDQUFFWixrQkFDUnRGLEtBQUsyTSxPQUFTekksU0FBU25ELGNBQWMsZ0JBQ3JDZixLQUFLNE0sTUFBUTFJLFNBQVNuRCxjQUFjLGNBQ3RDLENBRUEyRSxJQUFBQSxDQUFJaEQsR0FBaUIsSUFBaEIsS0FBRVcsRUFBSSxLQUFFRixHQUFNVCxFQUNqQjFDLEtBQUsyTSxPQUFPekgsSUFBTTdCLEVBQ2xCckQsS0FBSzJNLE9BQU94SCxJQUFNaEMsRUFDbEJuRCxLQUFLNE0sTUFBTXpMLFlBQWNnQyxFQUN6QitDLE1BQU1SLE1BQ1IsR0ptTG9DLGtCQUN0QzZGLEVBQVd6RixvQkFTWDZCLEVBQWtCdkYsaUJBQWlCLFNBUG5DLFdBQ0UsTUFBTSxLQUFFZSxFQUFJLElBQUV5RixHQUFRUixFQUFXTyxjQUNqQ2QsRUFBa0JuQixNQUFRdkQsRUFDMUIyRSxFQUF3QnBCLE1BQVFrQyxFQUNoQ3FELEVBQXFCNUosa0JBQ3JCa0ssRUFBYzdHLE1BQ2hCLElBRUFzQyxFQUFlNUYsaUJBQWlCLFNBQVMsS0FDdkM0SixFQUFpQjNKLGtCQUNqQm9LLEVBQWEvRyxNQUFNLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy91dGlscy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwQ29uZmlybWF0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKGZvcm1FbGVtZW50LCBjb25maWcpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gY29uZmlnLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IGNvbmZpZy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gY29uZmlnLmVycm9yQ2xhc3M7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2NoZWNrRm9ybVZhbGlkaXR5ID0gKCkgPT5cclxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZXZlcnkoKGlucHV0KSA9PiBpbnB1dC52YWxpZGl0eS52YWxpZCk7XHJcblxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGNvbnN0IHZhbGlkID0gdGhpcy5fY2hlY2tGb3JtVmFsaWRpdHkoKTtcclxuICAgIGlmICh2YWxpZCkge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvL1xyXG4gICAgLy8gY29uc3QgaXNWYWxpZCA9IHRoaXMuaW5wdXRFbGVtZW50cy5zb21lKChpbnB1dEVsZW1lbnQpPT4ge1xyXG4gICAgLy8gICAgIHJldHVybiBpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWRcclxuICAgIC8vIH0pXHJcbiAgICAvLyBpZiAoaXNWYWxpZCkge1xyXG4gICAgLy8gICAgIHN1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgLy8gICAgIHN1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAvLyAgIH0gZWxzZSB7XHJcbiAgICAvLyAgICAgc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAvLyAgICAgc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAvLyAgIH1cclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMgPSBbXHJcbiAgICAgIC4uLnRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvciksXHJcbiAgICBdO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcclxuICAgICk7XHJcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSh0aGlzLl9pbnB1dEVsZW1lbnRzLCB0aGlzLl9zdWJtaXRCdXR0b24pO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKHRoaXMuX2Zvcm1FbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3Ioe1xyXG4gICAgZGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIGhhbmRsZVByZXZpZXdJbWFnZSxcclxuICAgIGhhbmRsZUxpa2VDYXJkLFxyXG4gICAgY3VycmVudFVzZXJJZCxcclxuICAgIGhhbmRsZURlbGV0ZUNhcmQsXHJcbiAgICBvd25lcixcclxuICB9KSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2lzTGlrZWQgPSAhIWRhdGEuaXNMaWtlZDtcclxuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XHJcblxyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZVByZXZpZXdJbWFnZTtcclxuICAgIHRoaXMuX2hhbmRsZUxpa2VDYXJkID0gaGFuZGxlTGlrZUNhcmQ7XHJcbiAgICB0aGlzLl9jdXJyZW50VXNlcklkID0gY3VycmVudFVzZXJJZDtcclxuICAgIHRoaXMuX293bmVyID0gZGF0YS5vd25lci5faWQ7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkID0gaGFuZGxlRGVsZXRlQ2FyZDtcclxuICAgIGNvbnNvbGUubG9nKHRoaXMuX293bmVyKTtcclxuICB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDbGljaygpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVMaWtlcyhpc0xpa2VkKSB7XHJcbiAgICB0aGlzLl9pc0xpa2VkID0gaXNMaWtlZDtcclxuICAgIHRoaXMucmVuZGVyTGlrZXMoKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckxpa2VzKCkge1xyXG4gICAgLy8gdGhpcy5fY2FyZExpa2VzLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG4gICAgY29uc3QgaXNMaWtlZCA9IHRoaXMuaXNMaWtlZCgpO1xyXG4gICAgaWYgKGlzTGlrZWQpIHtcclxuICAgICAgdGhpcy5saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmxpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGlzTGlrZWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faXNMaWtlZDtcclxuICB9XHJcblxyXG4gIF9jaGVja0lkRm9yRGVsZXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX293bmVyID09PSB0aGlzLl9jdXJyZW50VXNlcklkKSB7XHJcbiAgICAgIHRoaXMuYWRkVHJhc2goKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMucmVtb3ZlVHJhc2goKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFkZFRyYXNoKCkge1xyXG4gICAgdGhpcy5jYXJkVHJhc2hCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX3RyYXNoLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgfVxyXG5cclxuICByZW1vdmVUcmFzaCgpIHtcclxuICAgIHRoaXMuY2FyZFRyYXNoQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX190cmFzaC1idXR0b25fYWN0aXZlXCIpO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2FyZCh0aGlzLmlzTGlrZWQoKSlcclxuICAgICk7XHJcbiAgICB0aGlzLmNhcmRUcmFzaEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkKHRoaXMuX2lkKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljaygpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgIHRoaXMubGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuY2FyZFRyYXNoQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RyYXNoLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgY29uc3QgY2FyZFRpdGxlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG4gICAgdGhpcy5jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuY2FyZEltYWdlLmFsdCA9IHRoaXMuX25hbWU7XHJcbiAgICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fY2FyZExpa2VzID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2VzLWNvdW50ZXJcIik7XHJcbiAgICB0aGlzLnJlbmRlckxpa2VzKCk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fY2hlY2tJZEZvckRlbGV0ZSgpO1xyXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcclxuICAgICAgaWYgKFxyXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBcIikgfHxcclxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX19jbG9zZWJ1dHRvblwiKVxyXG4gICAgICApIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5fbW9kYWxTYXZlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2J1dHRvblwiKTtcclxuICAgIHRoaXMuX3NhdmVCdXR0b25UZXh0ID0gdGhpcy5fbW9kYWxTYXZlQnV0dG9uLnRleHRDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWUoKSB7XHJcbiAgICBjb25zdCBpbnB1dHMgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9faW5wdXRcIik7XHJcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xyXG4gICAgaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZSgpKVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX21vZGFsU2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9tb2RhbFNhdmVCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zYXZlQnV0dG9uVGV4dDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoRm9ybTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgc2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcygpIHtcclxuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG59XHJcbiIsImNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS95b3NlbWl0ZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJhbGQgbW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhdGVtYXIuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiLFxyXG4gIH0sXHJcbl07XHJcblxyXG5jb25zdCBwcm9maWxlTW9kYWxCb3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsXCIpO1xyXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XHJcbmNvbnN0IHByb2ZpbGVNb2RhbENsb3NlQnV0dG9uID1cclxuICBwcm9maWxlTW9kYWxCb3gucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1jbG9zZWJ1dHRvblwiKTtcclxuY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gcHJvZmlsZU1vZGFsQm94LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtZm9ybVwiKTtcclxuY29uc3QgcHJvZmlsZVRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwLW5hbWVcIik7XHJcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwb3B1cC1kZXNjcmlwdGlvblwiKTtcclxuY29uc3QgYWRkTW9kYWxCb3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1wb3B1cFwiKTtcclxuY29uc3QgYWRkTW9kYWxCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbmNvbnN0IGFkZE1vZGFsRm9ybSA9IGFkZE1vZGFsQm94LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLXBvcHVwZm9ybVwiKTtcclxuY29uc3QgaW1hZ2VNb2RhbFdpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1wb3B1cFwiKTtcclxuY29uc3QgaW1hZ2VDbG9zZUJ1dHRvbiA9IGltYWdlTW9kYWxXaW5kb3cucXVlcnlTZWxlY3RvcihcIiNwb3B1cC1jbG9zZWJ1dHRvblwiKTtcclxuY29uc3QgYXZpRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZpLXBvcHVwZm9ybVwiKTtcclxuXHJcbmNvbnN0IGZvcm1WYWxpZGF0aW9uQ29uZmlnID0ge1xyXG4gIGlucHV0U2VsZWN0b3I6IFwiLnBvcHVwX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5wb3B1cF9fYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJwb3B1cF9fZXJyb3JfdmlzaWJsZVwiLFxyXG59O1xyXG5leHBvcnQgZnVuY3Rpb24gaGFuZGxlT3ZlcmxheUNsb3NlKGV2dCkge1xyXG4gIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwXCIpKSB7XHJcbiAgICBjbG9zZU1vZGFsKGV2dC50YXJnZXQpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGhhbmRsZUVzY1VwKGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICBjb25zdCBvcGVuUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX29wZW5lZFwiKTtcclxuICAgIGNsb3NlTW9kYWwob3BlblBvcHVwKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgaGFuZGxlT3ZlcmxheUNsb3NlKTtcclxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgaGFuZGxlRXNjVXApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xyXG4gIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgbW9kYWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBoYW5kbGVPdmVybGF5Q2xvc2UpO1xyXG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCBoYW5kbGVFc2NVcCk7XHJcbn1cclxuXHJcbmV4cG9ydCB7XHJcbiAgZm9ybVZhbGlkYXRpb25Db25maWcsXHJcbiAgaW1hZ2VDbG9zZUJ1dHRvbixcclxuICBpbWFnZU1vZGFsV2luZG93LFxyXG4gIGFkZE1vZGFsRm9ybSxcclxuICBhZGRNb2RhbEJ1dHRvbixcclxuICBhZGRNb2RhbEJveCxcclxuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCxcclxuICBwcm9maWxlVGl0bGVJbnB1dCxcclxuICBwcm9maWxlRWRpdEZvcm0sXHJcbiAgcHJvZmlsZU1vZGFsQ2xvc2VCdXR0b24sXHJcbiAgcHJvZmlsZUVkaXRCdXR0b24sXHJcbiAgcHJvZmlsZU1vZGFsQm94LFxyXG4gIGF2aUZvcm0sXHJcbn07XHJcbiIsImltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgUG9wdXAgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXAuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm1hdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cENvbmZpcm1hdGlvbi5qc1wiO1xyXG5pbXBvcnQge1xyXG4gIGZvcm1WYWxpZGF0aW9uQ29uZmlnLFxyXG4gIGltYWdlQ2xvc2VCdXR0b24sXHJcbiAgaW1hZ2VNb2RhbFdpbmRvdyxcclxuICBhZGRNb2RhbEZvcm0sXHJcbiAgYWRkTW9kYWxCdXR0b24sXHJcbiAgYWRkTW9kYWxCb3gsXHJcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQsXHJcbiAgcHJvZmlsZVRpdGxlSW5wdXQsXHJcbiAgcHJvZmlsZUVkaXRGb3JtLFxyXG4gIHByb2ZpbGVNb2RhbENsb3NlQnV0dG9uLFxyXG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxyXG4gIHByb2ZpbGVNb2RhbEJveCxcclxuICBhdmlGb3JtLFxyXG59IGZyb20gXCIuLi91dGlscy91dGlscy5qc1wiO1xyXG5cclxuY29uc3QgdXNlckluZm9FbCA9IG5ldyBVc2VySW5mbyh7XHJcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxyXG4gIGpvYlNlbGVjdG9yOiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxyXG4gIGF2YXRhclNlbGVjdG9yOiBcIi5wcm9maWxlX19pbWFnZVwiLFxyXG59KTtcclxuXHJcbi8qLS0tLS0tLS0tLSBBUEkgLS0tLS0tLS0tLSovXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjkyZjdlYmZhLTllOGUtNGZiOC1iMGEzLTFjZGFhMTVjY2JlMFwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcbmxldCBzZWN0aW9uRWw7XHJcbmxldCBjdXJyZW50VXNlcklkO1xyXG5hcGlcclxuICAuZ2V0QXBwSW5mbygpXHJcbiAgLnRoZW4oKFt1c2VyRGF0YSwgY2FyZERhdGFdKSA9PiB7XHJcbiAgICBjdXJyZW50VXNlcklkID0gdXNlckRhdGEuX2lkO1xyXG4gICAgdXNlckluZm9FbC5zZXRVc2VySW5mbyh7IG5hbWU6IHVzZXJEYXRhLm5hbWUsIGpvYjogdXNlckRhdGEuYWJvdXQgfSk7XHJcbiAgICB1c2VySW5mb0VsLnNldEF2YXRhckluZm8odXNlckRhdGEuYXZhdGFyKTtcclxuXHJcbiAgICBzZWN0aW9uRWwgPSBuZXcgU2VjdGlvbihcclxuICAgICAge1xyXG4gICAgICAgIGl0ZW1zOiBjYXJkRGF0YSxcclxuXHJcbiAgICAgICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChkYXRhKTtcclxuICAgICAgICAgIHNlY3Rpb25FbC5hZGRJdGVtKGNhcmQpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICAgIFwiLmNhcmRzX19saXN0XCJcclxuICAgICk7XHJcbiAgICBzZWN0aW9uRWwucmVuZGVySXRlbXMoKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gIH0pO1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChkYXRhKSB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKHtcclxuICAgIGRhdGEsXHJcbiAgICBjYXJkU2VsZWN0b3I6IFwiI2NhcmQtdGVtcGxhdGVcIixcclxuICAgIGN1cnJlbnRVc2VySWQsXHJcbiAgICBoYW5kbGVQcmV2aWV3SW1hZ2U6ICgpID0+IHtcclxuICAgICAgaW1hZ2VQb3B1cC5vcGVuKGRhdGEpO1xyXG4gICAgfSxcclxuICAgIGhhbmRsZUxpa2VDYXJkOiAoc2hvdWxkUmVtb3ZlTGlrZSkgPT4ge1xyXG4gICAgICBpZiAoc2hvdWxkUmVtb3ZlTGlrZSkge1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLnJlbW92ZUxpa2UoZGF0YS5faWQpXHJcbiAgICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBjYXJkLnVwZGF0ZUxpa2VzKGRhdGEuaXNMaWtlZCk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLmFkZExpa2UoZGF0YS5faWQpXHJcbiAgICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBjYXJkLnVwZGF0ZUxpa2VzKGRhdGEuaXNMaWtlZCk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgaGFuZGxlRGVsZXRlQ2FyZDogKGNhcmRJZCkgPT4ge1xyXG4gICAgICBkZWxldGVQb3B1cC5vcGVuKCk7XHJcbiAgICAgIGRlbGV0ZVBvcHVwLnNldFN1Ym1pdEFjdGlvbigoKSA9PiB7XHJcbiAgICAgICAgZGVsZXRlUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuICAgICAgICBhcGlcclxuICAgICAgICAgIC5kZWxldGVDYXJkKGNhcmRJZClcclxuICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgY2FyZC5kZWxldGVDbGljaygpO1xyXG4gICAgICAgICAgICBkZWxldGVQb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICBkZWxldGVQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0sXHJcbiAgfSk7XHJcbiAgcmV0dXJuIGNhcmQuZ2VuZXJhdGVDYXJkKCk7XHJcbn1cclxuXHJcbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihhZGRNb2RhbEZvcm0sIGZvcm1WYWxpZGF0aW9uQ29uZmlnKTtcclxuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5jb25zdCBwcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIHByb2ZpbGVFZGl0Rm9ybSxcclxuICBmb3JtVmFsaWRhdGlvbkNvbmZpZ1xyXG4pO1xyXG5wcm9maWxlRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5jb25zdCBhdmlGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoYXZpRm9ybSwgZm9ybVZhbGlkYXRpb25Db25maWcpO1xyXG5hdmlGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmNvbnN0IGRlbGV0ZVBvcHVwID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbihcIiNkZWxldGUtcG9wdXBcIik7XHJcbmRlbGV0ZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBlZGl0Rm9ybU1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjbW9kYWxcIiwgKGlucHV0VmFsdWVzKSA9PiB7XHJcbiAgZWRpdEZvcm1Nb2RhbC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmVkaXRQcm9maWxlKGlucHV0VmFsdWVzKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICB1c2VySW5mb0VsLnNldFVzZXJJbmZvKHtcclxuICAgICAgICBuYW1lOiBpbnB1dFZhbHVlcy5uYW1lLFxyXG4gICAgICAgIGpvYjogaW5wdXRWYWx1ZXMuZGVzY3JpcHRpb24sXHJcbiAgICAgIH0pO1xyXG4gICAgICBlZGl0Rm9ybU1vZGFsLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGVkaXRGb3JtTW9kYWwucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufSk7XHJcbmVkaXRGb3JtTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGFkZEZvcm1Nb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI2FkZC1wb3B1cFwiLCAoaW5wdXRWYWx1ZXMpID0+IHtcclxuICBhZGRGb3JtTW9kYWwucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuICBhcGlcclxuICAgIC5hZGROZXdDYXJkKGlucHV0VmFsdWVzKVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgY29uc3QgY2FyZCA9IGNyZWF0ZUNhcmQoZGF0YSk7XHJcbiAgICAgIHNlY3Rpb25FbC5hZGRJdGVtKGNhcmQpO1xyXG4gICAgICBhZGRGb3JtTW9kYWwuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgYWRkRm9ybU1vZGFsLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG5hZGRGb3JtTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IHVwZGF0ZVByb2ZpbGVGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjYXZpLXBvcHVwXCIsIChpbnB1dFZhbHVlcykgPT4ge1xyXG4gIHVwZGF0ZVByb2ZpbGVGb3JtLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAudXBkYXRlUHJvZmlsZVBpY3R1cmUoaW5wdXRWYWx1ZXMpXHJcbiAgICAudGhlbigodmFsdWUpID0+IHtcclxuICAgICAgdXNlckluZm9FbC5zZXRBdmF0YXJJbmZvKHZhbHVlLmF2YXRhcik7XHJcbiAgICAgIHVwZGF0ZVByb2ZpbGVGb3JtLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHVwZGF0ZVByb2ZpbGVGb3JtLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG51cGRhdGVQcm9maWxlRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgcHJvZmlsZUVkaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlXCIpO1xyXG5wcm9maWxlRWRpdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHVwZGF0ZVByb2ZpbGVGb3JtLm9wZW4oKTtcclxuICBhdmlGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjcHJldmlldy1wb3B1cFwiKTtcclxuaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZnVuY3Rpb24gb3BlblByb2ZpbGVNb2RhbCgpIHtcclxuICBjb25zdCB7IG5hbWUsIGpvYiB9ID0gdXNlckluZm9FbC5nZXRVc2VySW5mbygpO1xyXG4gIHByb2ZpbGVUaXRsZUlucHV0LnZhbHVlID0gbmFtZTtcclxuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IGpvYjtcclxuICBwcm9maWxlRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuICBlZGl0Rm9ybU1vZGFsLm9wZW4oKTtcclxufVxyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb3BlblByb2ZpbGVNb2RhbCk7XHJcbmFkZE1vZGFsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgYWRkRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuICBhZGRGb3JtTW9kYWwub3BlbigpO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGNsb3NlUHJvZmlsZU1vZGFsKCkge1xyXG4gIGVkaXRGb3JtTW9kYWwuY2xvc2UoKTtcclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yLCBhdmF0YXJTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9uYW1lRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9qb2JFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBuYW1lOiB0aGlzLl9uYW1lRWwudGV4dENvbnRlbnQsXHJcbiAgICAgIGpvYjogdGhpcy5fam9iRWwudGV4dENvbnRlbnQsXHJcbiAgICAgIGF2YXRhcjogdGhpcy5fYXZhdGFyRUxlbWVudCxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRBdmF0YXJJbmZvKGF2YXRhcikge1xyXG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMgPSBhdmF0YXI7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGpvYiB9KSB7XHJcbiAgICB0aGlzLl9uYW1lRWwudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5fam9iRWwudGV4dENvbnRlbnQgPSBqb2I7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZ2V0QXBwSW5mbygpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRVc2VySW5mbygpLCB0aGlzLmluaXRpYWxDYXJkcygpXSk7XHJcbiAgfVxyXG5cclxuICBpbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBlZGl0UHJvZmlsZSh7IG5hbWUsIGRlc2NyaXB0aW9uIH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgIGFib3V0OiBkZXNjcmlwdGlvbixcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgYWRkTmV3Q2FyZCh7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwicG9zdFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBsaW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBjYXJkTGlrZXMoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChjYXJkSUQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJRH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBhZGRMaWtlKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgaXNMaWtlZDogdHJ1ZSxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZW1vdmVMaWtlKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuICB1cGRhdGVQcm9maWxlUGljdHVyZShhdmF0YXIpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShhdmF0YXIpLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIC8vIG90aGVyIG1ldGhvZHMgZm9yIHdvcmtpbmcgd2l0aCB0aGUgQVBJXHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9jb25maXJtQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZWxldGVfX2J1dHRvblwiKTtcclxuICAgIHRoaXMuX3NhdmVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19idXR0b25cIik7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVTdWJtaXQoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZykge1xyXG4gICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICB0aGlzLl9jb25maXJtQnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2NvbmZpcm1CdXR0b24udGV4dENvbnRlbnQgPSBcInllc1wiO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0U3VibWl0QWN0aW9uKGFjdGlvbikge1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlU3VibWl0ID0gYWN0aW9uO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX2ltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwb3B1cC1pbWFnZVwiKTtcclxuICAgIHRoaXMuX3RleHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwLXRleHRcIik7XHJcbiAgfVxyXG5cclxuICBvcGVuKHsgbGluaywgbmFtZSB9KSB7XHJcbiAgICB0aGlzLl9pbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gbmFtZTtcclxuICAgIHRoaXMuX3RleHQudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiRm9ybVZhbGlkYXRvciIsImNvbnN0cnVjdG9yIiwiZm9ybUVsZW1lbnQiLCJjb25maWciLCJ0aGlzIiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsImNsYXNzTGlzdCIsImFkZCIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJyZW1vdmUiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9jaGVja0Zvcm1WYWxpZGl0eSIsIl9pbnB1dEVsZW1lbnRzIiwiZXZlcnkiLCJpbnB1dCIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9zdWJtaXRCdXR0b24iLCJkaXNhYmxlZCIsIl9zZXRFdmVudExpc3RlbmVycyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlc2V0VmFsaWRhdGlvbiIsImVuYWJsZVZhbGlkYXRpb24iLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsIkNhcmQiLCJfcmVmIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZVByZXZpZXdJbWFnZSIsImhhbmRsZUxpa2VDYXJkIiwiY3VycmVudFVzZXJJZCIsImhhbmRsZURlbGV0ZUNhcmQiLCJvd25lciIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9pc0xpa2VkIiwiaXNMaWtlZCIsIl9pZCIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVMaWtlQ2FyZCIsIl9jdXJyZW50VXNlcklkIiwiX293bmVyIiwiX2hhbmRsZURlbGV0ZUNhcmQiLCJjb25zb2xlIiwibG9nIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJjb250ZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJjbG9uZU5vZGUiLCJkZWxldGVDbGljayIsIl9lbGVtZW50IiwidXBkYXRlTGlrZXMiLCJyZW5kZXJMaWtlcyIsImxpa2VCdXR0b24iLCJfY2hlY2tJZEZvckRlbGV0ZSIsImFkZFRyYXNoIiwicmVtb3ZlVHJhc2giLCJjYXJkVHJhc2hCdXR0b24iLCJjYXJkSW1hZ2UiLCJnZW5lcmF0ZUNhcmQiLCJjYXJkVGl0bGUiLCJzcmMiLCJhbHQiLCJfY2FyZExpa2VzIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJvcGVuIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9tb2RhbFNhdmVCdXR0b24iLCJfc2F2ZUJ1dHRvblRleHQiLCJfZ2V0SW5wdXRWYWx1ZSIsImlucHV0cyIsImlucHV0VmFsdWVzIiwidmFsdWUiLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwicmVzZXQiLCJTZWN0aW9uIiwic2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsInByb2ZpbGVNb2RhbEJveCIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZUVkaXRGb3JtIiwicHJvZmlsZVRpdGxlSW5wdXQiLCJwcm9maWxlRGVzY3JpcHRpb25JbnB1dCIsImFkZE1vZGFsQm94IiwiYWRkTW9kYWxCdXR0b24iLCJhZGRNb2RhbEZvcm0iLCJhdmlGb3JtIiwiZm9ybVZhbGlkYXRpb25Db25maWciLCJ1c2VySW5mb0VsIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9uYW1lRWwiLCJfam9iRWwiLCJfYXZhdGFyRWxlbWVudCIsImdldFVzZXJJbmZvIiwiam9iIiwiYXZhdGFyIiwiX2F2YXRhckVMZW1lbnQiLCJzZXRBdmF0YXJJbmZvIiwic2V0VXNlckluZm8iLCJfcmVmMiIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsIl9jaGVja1Jlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImZldGNoIiwibWV0aG9kIiwidGhlbiIsImdldEFwcEluZm8iLCJhbGwiLCJpbml0aWFsQ2FyZHMiLCJlZGl0UHJvZmlsZSIsImRlc2NyaXB0aW9uIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsImFkZE5ld0NhcmQiLCJfcmVmMyIsImNhcmRMaWtlcyIsImNhcmRJZCIsImRlbGV0ZUNhcmQiLCJjYXJkSUQiLCJhZGRMaWtlIiwicmVtb3ZlTGlrZSIsInVwZGF0ZVByb2ZpbGVQaWN0dXJlIiwiYXV0aG9yaXphdGlvbiIsInNlY3Rpb25FbCIsImNyZWF0ZUNhcmQiLCJjYXJkIiwiaW1hZ2VQb3B1cCIsInNob3VsZFJlbW92ZUxpa2UiLCJjYXRjaCIsImVyciIsImRlbGV0ZVBvcHVwIiwic2V0U3VibWl0QWN0aW9uIiwiZmluYWxseSIsInVzZXJEYXRhIiwiY2FyZERhdGEiLCJhZGRGb3JtVmFsaWRhdG9yIiwicHJvZmlsZUZvcm1WYWxpZGF0b3IiLCJhdmlGb3JtVmFsaWRhdG9yIiwiX2NvbmZpcm1CdXR0b24iLCJfc2F2ZUJ1dHRvbiIsIl9oYW5kbGVEZWxldGVTdWJtaXQiLCJhY3Rpb24iLCJlZGl0Rm9ybU1vZGFsIiwiUG9wdXBXaXRoRm9ybSIsImFkZEZvcm1Nb2RhbCIsInVwZGF0ZVByb2ZpbGVGb3JtIiwiX2ltYWdlIiwiX3RleHQiXSwic291cmNlUm9vdCI6IiJ9