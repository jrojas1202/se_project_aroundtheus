!function(){"use strict";class e{constructor(e,t){this._formElement=e,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_checkFormValidity=()=>this._inputElements.every((e=>e.validity.valid));_toggleButtonState(){this._checkFormValidity()?(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1):(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0)}_setEventListeners(){this._inputElements=[...this._formElement.querySelectorAll(this._inputSelector)],this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState(this._inputElements,this._submitButton)}))}))}resetValidation(){this._toggleButtonState(),this._inputElements.forEach((e=>{this._hideInputError(e)}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners(this._formElement)}}class t{constructor(e){let{data:t,cardSelector:s,handlePreviewImage:r,handleLikeCard:n,currentUserId:i,handleDeleteCard:o,owner:a}=e;this._name=t.name,this._link=t.link,this._likes=t.likes,this._id=t._id,this._cardSelector=s,this._handleImageClick=r,this._handleLikeCard=n,this._currentUserId=i,this._owner=t.owner._id,this._handleDeleteCard=o,console.log(this._owner)}_getTemplate(){return document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0)}deleteClick(){this._element.remove()}updateLikes(e){this._likes=e,this.renderLikes()}renderLikes(){this._cardLikes.textContent=this._likes.length,this.isLiked()?this.likeButton.classList.add("card__like-button_active"):this.likeButton.classList.remove("card__like-button_active")}isLiked(){return this._likes.some((e=>e._id===this._currentUserId))}_checkIdForDelete(){this._owner===this._currentUserId?this.addTrash():this.removeTrash()}addTrash(){this.cardTrashButton.classList.remove("card__trash-button_active")}removeTrash(){this.cardTrashButton.classList.add("card__trash-button_active")}_setEventListeners(){this.likeButton.addEventListener("click",(()=>this._handleLikeCard(this.isLiked()))),this.cardTrashButton.addEventListener("click",(()=>{this._handleDeleteCard(this._id)})),this.cardImage.addEventListener("click",(()=>{this._handleImageClick()}))}generateCard(){this._element=this._getTemplate(),this.likeButton=this._element.querySelector(".card__like-button"),this.cardTrashButton=this._element.querySelector(".card__trash-button"),this.cardImage=this._element.querySelector(".card__image");const e=this._element.querySelector(".card__title");return this.cardImage.src=this._link,this.cardImage.alt=this._name,e.textContent=this._name,this._cardLikes=this._element.querySelector(".card__likes-counter"),this.renderLikes(),this._setEventListeners(),this._checkIdForDelete(),this._element}}class s{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__closebutton"))&&this.close()}))}}var r=class extends s{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".popup__form"),this._handleFormSubmit=t,this._modalSaveButton=this._popupElement.querySelector(".popup__button"),this._saveButtonText=this._modalSaveButton.textContent}_getInputValue(){const e=this._popupForm.querySelectorAll(".popup__input"),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(()=>this._handleFormSubmit(this._getInputValue())))}renderLoading(e){this._modalSaveButton.textContent=e?"Saving...":this._saveButtonText}close(){this._popupForm.reset(),super.close()}};class n{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}const i=document.querySelector("#modal"),o=document.querySelector(".profile__edit-button"),a=(i.querySelector("#modal-closebutton"),i.querySelector("#modal-form")),l=document.querySelector("#popup-name"),c=document.querySelector("#popup-description"),h=document.querySelector("#add-popup"),d=document.querySelector(".profile__add-button");console.log(h);const u=h.querySelector("#add-popupform"),_=(document.querySelector("#preview-popup").querySelector("#popup-closebutton"),document.querySelector("#avi-popupform")),p={inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},m=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:r}=e;this._nameEl=document.querySelector(t),this._jobEl=document.querySelector(s),this._avatarElement=document.querySelector(r)}getUserInfo(){return{name:this._nameEl.textContent,job:this._jobEl.textContent,avatar:this._avatarELement}}setAvatarInfo(e){this._avatarElement.src=e}setUserInfo(e){let{name:t,job:s}=e;this._nameEl.textContent=t,this._jobEl.textContent=s}}({nameSelector:".profile__title",jobSelector:".profile__description",avatarSelector:".profile__image"}),v=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error ${e.status}`)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then(this._checkResponse)}getAppInfo(){return Promise.all([this.getUserInfo(),this.initialCards()])}initialCards(){return fetch(`${this._baseUrl}/cards`,{method:"GET",headers:this._headers}).then(this._checkResponse)}editProfile(e){let{name:t,description:s}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})}).then(this._checkResponse)}addNewCard(e){let{name:t,link:s}=e;return fetch(`${this._baseUrl}/cards`,{method:"post",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then(this._checkResponse)}cardLikes(e){return fetch(`${this._baseUrl}/cards/likes/${e}`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}addLike(e){let{_id:t}=e;return fetch(`${this._baseUrl}/cards/likes/${t}`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}removeLike(e){let{_id:t}=e;return fetch(`${this._baseUrl}/cards/likes/${t}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}updateProfilePicture(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"92f7ebfa-9e8e-4fb8-b0a3-1cdaa15ccbe0","Content-Type":"application/json"}});let E,b;function S(e){const s=new t({data:e,cardSelector:"#card-template",currentUserId:b,handlePreviewImage:()=>{q.open(e)},handleLikeCard:t=>{t?v.removeLike(e).then((e=>{s.updateLikes(e.likes)})).catch((e=>{console.log(e)})):v.addLike(e).then((e=>{s.updateLikes(e.likes)})).catch((e=>{console.log(e)}))},handleDeleteCard:e=>{g.open(),g.setSubmitAction((()=>{g.renderLoading(!0),v.deleteCard(e).then((()=>{s.deleteClick(),g.close()})).catch((e=>{console.log(e)})).finally((()=>{g.renderLoading(!1)}))}))}});return s.generateCard()}v.getAppInfo().then((e=>{let[t,s]=e;b=t._id,m.setUserInfo({name:t.name,job:t.about}),m.setAvatarInfo(t.avatar),E=new n({items:s,renderer:e=>{const t=S(e);E.addItem(t)}},".cards__list"),E.renderItems()})).catch((e=>{console.log(e)}));const k=new e(u,p);k.enableValidation(),console.log(u);const L=new e(a,p);L.enableValidation();const f=new e(_,p);f.enableValidation();const g=new class extends s{constructor(e){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".popup__form"),this._confirmButton=document.querySelector("#delete__button"),this._saveButton=document.querySelector(".popup__button")}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleDeleteSubmit()}))}renderLoading(e){this._confirmButton.textContent=e?"Saving...":"yes"}setSubmitAction(e){this._handleDeleteSubmit=e}}("#delete-popup");g.setEventListeners();const y=new r("#modal",(e=>{y.renderLoading(!0),v.editProfile(e).then((()=>{m.setUserInfo({name:e.name,job:e.description}),y.close()})).catch((e=>{console.log(e)})).finally((()=>{y.renderLoading(!1)}))}));y.setEventListeners();const C=new r("#add-popup",(e=>{C.renderLoading(!0),v.addNewCard(e).then((e=>{const t=S(e);E.addItem(t),C.close()})).catch((e=>{console.log(e)})).finally((()=>{C.renderLoading(!1)}))}));C.setEventListeners();const I=new r("#avi-popup",(e=>{I.renderLoading(!0),v.updateProfilePicture(e).then((e=>{m.setAvatarInfo(e.avatar),I.close()})).catch((e=>{console.log(e)})).finally((()=>{I.renderLoading(!1)}))}));I.setEventListeners(),document.querySelector(".profile__image").addEventListener("click",(()=>{I.open(),f.resetValidation()}));const q=new class extends s{constructor(e){super({popupSelector:e}),this._image=document.querySelector("#popup-image"),this._text=document.querySelector("#popup-text")}open(e){let{link:t,name:s}=e;this._image.src=t,this._image.alt=s,this._text.textContent=s,super.open()}}("#preview-popup");q.setEventListeners(),o.addEventListener("click",(function(){const{name:e,job:t}=m.getUserInfo();l.value=e,c.value=t,L.resetValidation(),y.open()})),d.addEventListener("click",(()=>{k.resetValidation(),C.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvdXRpbHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3Rvcihmb3JtRWxlbWVudCwgY29uZmlnKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGNvbmZpZy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBjb25maWcuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IGNvbmZpZy5lcnJvckNsYXNzO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9jaGVja0Zvcm1WYWxpZGl0eSA9ICgpID0+XHJcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmV2ZXJ5KChpbnB1dCkgPT4gaW5wdXQudmFsaWRpdHkudmFsaWQpO1xyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBjb25zdCB2YWxpZCA9IHRoaXMuX2NoZWNrRm9ybVZhbGlkaXR5KCk7XHJcbiAgICBpZiAodmFsaWQpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgLy9cclxuICAgIC8vIGNvbnN0IGlzVmFsaWQgPSB0aGlzLmlucHV0RWxlbWVudHMuc29tZSgoaW5wdXRFbGVtZW50KT0+IHtcclxuICAgIC8vICAgICByZXR1cm4gaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkXHJcbiAgICAvLyB9KVxyXG4gICAgLy8gaWYgKGlzVmFsaWQpIHtcclxuICAgIC8vICAgICBzdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIC8vICAgICBzdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgLy8gICB9IGVsc2Uge1xyXG4gICAgLy8gICAgIHN1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgLy8gICAgIHN1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgLy8gICB9XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzID0gW1xyXG4gICAgICAuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpLFxyXG4gICAgXTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUodGhpcy5faW5wdXRFbGVtZW50cywgdGhpcy5fc3VibWl0QnV0dG9uKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycyh0aGlzLl9mb3JtRWxlbWVudCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKHtcclxuICAgIGRhdGEsXHJcbiAgICBjYXJkU2VsZWN0b3IsXHJcbiAgICBoYW5kbGVQcmV2aWV3SW1hZ2UsXHJcbiAgICBoYW5kbGVMaWtlQ2FyZCxcclxuICAgIGN1cnJlbnRVc2VySWQsXHJcbiAgICBoYW5kbGVEZWxldGVDYXJkLFxyXG4gICAgb3duZXIsXHJcbiAgfSkge1xyXG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XHJcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xyXG5cclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVQcmV2aWV3SW1hZ2U7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2FyZCA9IGhhbmRsZUxpa2VDYXJkO1xyXG4gICAgdGhpcy5fY3VycmVudFVzZXJJZCA9IGN1cnJlbnRVc2VySWQ7XHJcbiAgICB0aGlzLl9vd25lciA9IGRhdGEub3duZXIuX2lkO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCA9IGhhbmRsZURlbGV0ZUNhcmQ7XHJcbiAgICBjb25zb2xlLmxvZyh0aGlzLl9vd25lcik7XHJcbiAgfVxyXG5cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2xpY2soKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlTGlrZXMobGlrZXMpIHtcclxuICAgIHRoaXMuX2xpa2VzID0gbGlrZXM7XHJcbiAgICB0aGlzLnJlbmRlckxpa2VzKCk7XHJcbiAgfVxyXG5cclxuICByZW5kZXJMaWtlcygpIHtcclxuICAgIHRoaXMuX2NhcmRMaWtlcy50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcclxuICAgIGNvbnN0IGlzTGlrZWQgPSB0aGlzLmlzTGlrZWQoKTtcclxuICAgIGlmIChpc0xpa2VkKSB7XHJcbiAgICAgIHRoaXMubGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBpc0xpa2VkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2xpa2VzLnNvbWUoKGxpa2UpID0+IGxpa2UuX2lkID09PSB0aGlzLl9jdXJyZW50VXNlcklkKTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lkRm9yRGVsZXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX293bmVyID09PSB0aGlzLl9jdXJyZW50VXNlcklkKSB7XHJcbiAgICAgIHRoaXMuYWRkVHJhc2goKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMucmVtb3ZlVHJhc2goKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFkZFRyYXNoKCkge1xyXG4gICAgdGhpcy5jYXJkVHJhc2hCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX3RyYXNoLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgfVxyXG5cclxuICByZW1vdmVUcmFzaCgpIHtcclxuICAgIHRoaXMuY2FyZFRyYXNoQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX190cmFzaC1idXR0b25fYWN0aXZlXCIpO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2FyZCh0aGlzLmlzTGlrZWQoKSlcclxuICAgICk7XHJcbiAgICB0aGlzLmNhcmRUcmFzaEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkKHRoaXMuX2lkKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljaygpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgIHRoaXMubGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuY2FyZFRyYXNoQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RyYXNoLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgY29uc3QgY2FyZFRpdGxlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG4gICAgdGhpcy5jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuY2FyZEltYWdlLmFsdCA9IHRoaXMuX25hbWU7XHJcbiAgICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fY2FyZExpa2VzID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2VzLWNvdW50ZXJcIik7XHJcbiAgICB0aGlzLnJlbmRlckxpa2VzKCk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fY2hlY2tJZEZvckRlbGV0ZSgpO1xyXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcclxuICAgICAgaWYgKFxyXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBcIikgfHxcclxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX19jbG9zZWJ1dHRvblwiKVxyXG4gICAgICApIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5fbW9kYWxTYXZlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2J1dHRvblwiKTtcclxuICAgIHRoaXMuX3NhdmVCdXR0b25UZXh0ID0gdGhpcy5fbW9kYWxTYXZlQnV0dG9uLnRleHRDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWUoKSB7XHJcbiAgICBjb25zdCBpbnB1dHMgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9faW5wdXRcIik7XHJcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xyXG4gICAgaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZSgpKVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX21vZGFsU2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9tb2RhbFNhdmVCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zYXZlQnV0dG9uVGV4dDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoRm9ybTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgc2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcygpIHtcclxuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG59XHJcbiIsImNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS95b3NlbWl0ZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJhbGQgbW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhdGVtYXIuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiLFxyXG4gIH0sXHJcbl07XHJcblxyXG5jb25zdCBwcm9maWxlTW9kYWxCb3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsXCIpO1xyXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XHJcbmNvbnN0IHByb2ZpbGVNb2RhbENsb3NlQnV0dG9uID1cclxuICBwcm9maWxlTW9kYWxCb3gucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1jbG9zZWJ1dHRvblwiKTtcclxuY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gcHJvZmlsZU1vZGFsQm94LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtZm9ybVwiKTtcclxuY29uc3QgcHJvZmlsZVRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwLW5hbWVcIik7XHJcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwb3B1cC1kZXNjcmlwdGlvblwiKTtcclxuY29uc3QgYWRkTW9kYWxCb3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1wb3B1cFwiKTtcclxuY29uc3QgYWRkTW9kYWxCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbmNvbnNvbGUubG9nKGFkZE1vZGFsQm94KTtcclxuY29uc3QgYWRkTW9kYWxGb3JtID0gYWRkTW9kYWxCb3gucXVlcnlTZWxlY3RvcihcIiNhZGQtcG9wdXBmb3JtXCIpO1xyXG5jb25zdCBpbWFnZU1vZGFsV2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LXBvcHVwXCIpO1xyXG5jb25zdCBpbWFnZUNsb3NlQnV0dG9uID0gaW1hZ2VNb2RhbFdpbmRvdy5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwLWNsb3NlYnV0dG9uXCIpO1xyXG5jb25zdCBhdmlGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmktcG9wdXBmb3JtXCIpO1xyXG5cclxuY29uc3QgZm9ybVZhbGlkYXRpb25Db25maWcgPSB7XHJcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcInBvcHVwX19lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcbmV4cG9ydCBmdW5jdGlvbiBoYW5kbGVPdmVybGF5Q2xvc2UoZXZ0KSB7XHJcbiAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBcIikpIHtcclxuICAgIGNsb3NlTW9kYWwoZXZ0LnRhcmdldCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaGFuZGxlRXNjVXAoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgIGNvbnN0IG9wZW5Qb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgY2xvc2VNb2RhbChvcGVuUG9wdXApO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xyXG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBoYW5kbGVPdmVybGF5Q2xvc2UpO1xyXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCBoYW5kbGVFc2NVcCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjbG9zZU1vZGFsKG1vZGFsKSB7XHJcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKTtcclxuICBtb2RhbC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGhhbmRsZU92ZXJsYXlDbG9zZSk7XHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGhhbmRsZUVzY1VwKTtcclxufVxyXG5cclxuZXhwb3J0IHtcclxuICBmb3JtVmFsaWRhdGlvbkNvbmZpZyxcclxuICBpbWFnZUNsb3NlQnV0dG9uLFxyXG4gIGltYWdlTW9kYWxXaW5kb3csXHJcbiAgYWRkTW9kYWxGb3JtLFxyXG4gIGFkZE1vZGFsQnV0dG9uLFxyXG4gIGFkZE1vZGFsQm94LFxyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LFxyXG4gIHByb2ZpbGVUaXRsZUlucHV0LFxyXG4gIHByb2ZpbGVFZGl0Rm9ybSxcclxuICBwcm9maWxlTW9kYWxDbG9zZUJ1dHRvbixcclxuICBwcm9maWxlRWRpdEJ1dHRvbixcclxuICBwcm9maWxlTW9kYWxCb3gsXHJcbiAgYXZpRm9ybSxcclxufTtcclxuIiwiaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCBQb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cC5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwQ29uZmlybWF0aW9uLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgZm9ybVZhbGlkYXRpb25Db25maWcsXHJcbiAgaW1hZ2VDbG9zZUJ1dHRvbixcclxuICBpbWFnZU1vZGFsV2luZG93LFxyXG4gIGFkZE1vZGFsRm9ybSxcclxuICBhZGRNb2RhbEJ1dHRvbixcclxuICBhZGRNb2RhbEJveCxcclxuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCxcclxuICBwcm9maWxlVGl0bGVJbnB1dCxcclxuICBwcm9maWxlRWRpdEZvcm0sXHJcbiAgcHJvZmlsZU1vZGFsQ2xvc2VCdXR0b24sXHJcbiAgcHJvZmlsZUVkaXRCdXR0b24sXHJcbiAgcHJvZmlsZU1vZGFsQm94LFxyXG4gIGF2aUZvcm0sXHJcbn0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzLmpzXCI7XHJcblxyXG5jb25zdCB1c2VySW5mb0VsID0gbmV3IFVzZXJJbmZvKHtcclxuICBuYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXHJcbiAgam9iU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXHJcbiAgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXHJcbn0pO1xyXG5cclxuLyotLS0tLS0tLS0tIEFQSSAtLS0tLS0tLS0tKi9cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiOTJmN2ViZmEtOWU4ZS00ZmI4LWIwYTMtMWNkYWExNWNjYmUwXCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxubGV0IHNlY3Rpb25FbDtcclxubGV0IGN1cnJlbnRVc2VySWQ7XHJcbmFwaVxyXG4gIC5nZXRBcHBJbmZvKClcclxuICAudGhlbigoW3VzZXJEYXRhLCBjYXJkRGF0YV0pID0+IHtcclxuICAgIGN1cnJlbnRVc2VySWQgPSB1c2VyRGF0YS5faWQ7XHJcbiAgICB1c2VySW5mb0VsLnNldFVzZXJJbmZvKHsgbmFtZTogdXNlckRhdGEubmFtZSwgam9iOiB1c2VyRGF0YS5hYm91dCB9KTtcclxuICAgIHVzZXJJbmZvRWwuc2V0QXZhdGFySW5mbyh1c2VyRGF0YS5hdmF0YXIpO1xyXG5cclxuICAgIHNlY3Rpb25FbCA9IG5ldyBTZWN0aW9uKFxyXG4gICAgICB7XHJcbiAgICAgICAgaXRlbXM6IGNhcmREYXRhLFxyXG5cclxuICAgICAgICByZW5kZXJlcjogKGRhdGEpID0+IHtcclxuICAgICAgICAgIGNvbnN0IGNhcmQgPSBjcmVhdGVDYXJkKGRhdGEpO1xyXG4gICAgICAgICAgc2VjdGlvbkVsLmFkZEl0ZW0oY2FyZCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgfSxcclxuICAgICAgXCIuY2FyZHNfX2xpc3RcIlxyXG4gICAgKTtcclxuICAgIHNlY3Rpb25FbC5yZW5kZXJJdGVtcygpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgfSk7XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGRhdGEpIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoe1xyXG4gICAgZGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcjogXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gICAgY3VycmVudFVzZXJJZCxcclxuICAgIGhhbmRsZVByZXZpZXdJbWFnZTogKCkgPT4ge1xyXG4gICAgICBpbWFnZVBvcHVwLm9wZW4oZGF0YSk7XHJcbiAgICB9LFxyXG4gICAgaGFuZGxlTGlrZUNhcmQ6IChzaG91bGRSZW1vdmVMaWtlKSA9PiB7XHJcbiAgICAgIGlmIChzaG91bGRSZW1vdmVMaWtlKSB7XHJcbiAgICAgICAgYXBpXHJcbiAgICAgICAgICAucmVtb3ZlTGlrZShkYXRhKVxyXG4gICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgY2FyZC51cGRhdGVMaWtlcyhkYXRhLmxpa2VzKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYXBpXHJcbiAgICAgICAgICAuYWRkTGlrZShkYXRhKVxyXG4gICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgY2FyZC51cGRhdGVMaWtlcyhkYXRhLmxpa2VzKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcbiAgICBoYW5kbGVEZWxldGVDYXJkOiAoY2FyZElkKSA9PiB7XHJcbiAgICAgIGRlbGV0ZVBvcHVwLm9wZW4oKTtcclxuICAgICAgZGVsZXRlUG9wdXAuc2V0U3VibWl0QWN0aW9uKCgpID0+IHtcclxuICAgICAgICBkZWxldGVQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLmRlbGV0ZUNhcmQoY2FyZElkKVxyXG4gICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBjYXJkLmRlbGV0ZUNsaWNrKCk7XHJcbiAgICAgICAgICAgIGRlbGV0ZVBvcHVwLmNsb3NlKCk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgICAgIGRlbGV0ZVBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuICB9KTtcclxuICByZXR1cm4gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxufVxyXG5cclxuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGFkZE1vZGFsRm9ybSwgZm9ybVZhbGlkYXRpb25Db25maWcpO1xyXG5hZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuY29uc29sZS5sb2coYWRkTW9kYWxGb3JtKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgcHJvZmlsZUVkaXRGb3JtLFxyXG4gIGZvcm1WYWxpZGF0aW9uQ29uZmlnXHJcbik7XHJcbnByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmNvbnN0IGF2aUZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihhdmlGb3JtLCBmb3JtVmFsaWRhdGlvbkNvbmZpZyk7XHJcbmF2aUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgZGVsZXRlUG9wdXAgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKFwiI2RlbGV0ZS1wb3B1cFwiKTtcclxuZGVsZXRlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGVkaXRGb3JtTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNtb2RhbFwiLCAoaW5wdXRWYWx1ZXMpID0+IHtcclxuICBlZGl0Rm9ybU1vZGFsLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAuZWRpdFByb2ZpbGUoaW5wdXRWYWx1ZXMpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvRWwuc2V0VXNlckluZm8oe1xyXG4gICAgICAgIG5hbWU6IGlucHV0VmFsdWVzLm5hbWUsXHJcbiAgICAgICAgam9iOiBpbnB1dFZhbHVlcy5kZXNjcmlwdGlvbixcclxuICAgICAgfSk7XHJcbiAgICAgIGVkaXRGb3JtTW9kYWwuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgZWRpdEZvcm1Nb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59KTtcclxuZWRpdEZvcm1Nb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgYWRkRm9ybU1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjYWRkLXBvcHVwXCIsIChpbnB1dFZhbHVlcykgPT4ge1xyXG4gIGFkZEZvcm1Nb2RhbC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmFkZE5ld0NhcmQoaW5wdXRWYWx1ZXMpXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChkYXRhKTtcclxuICAgICAgc2VjdGlvbkVsLmFkZEl0ZW0oY2FyZCk7XHJcbiAgICAgIGFkZEZvcm1Nb2RhbC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBhZGRGb3JtTW9kYWwucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufSk7XHJcbmFkZEZvcm1Nb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgdXBkYXRlUHJvZmlsZUZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNhdmktcG9wdXBcIiwgKGlucHV0VmFsdWVzKSA9PiB7XHJcbiAgdXBkYXRlUHJvZmlsZUZvcm0ucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuICBhcGlcclxuICAgIC51cGRhdGVQcm9maWxlUGljdHVyZShpbnB1dFZhbHVlcylcclxuICAgIC50aGVuKCh2YWx1ZSkgPT4ge1xyXG4gICAgICB1c2VySW5mb0VsLnNldEF2YXRhckluZm8odmFsdWUuYXZhdGFyKTtcclxuICAgICAgdXBkYXRlUHJvZmlsZUZvcm0uY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgdXBkYXRlUHJvZmlsZUZvcm0ucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufSk7XHJcbnVwZGF0ZVByb2ZpbGVGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBwcm9maWxlRWRpdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VcIik7XHJcbnByb2ZpbGVFZGl0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgdXBkYXRlUHJvZmlsZUZvcm0ub3BlbigpO1xyXG4gIGF2aUZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pO1xyXG5cclxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNwcmV2aWV3LXBvcHVwXCIpO1xyXG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5mdW5jdGlvbiBvcGVuUHJvZmlsZU1vZGFsKCkge1xyXG4gIGNvbnN0IHsgbmFtZSwgam9iIH0gPSB1c2VySW5mb0VsLmdldFVzZXJJbmZvKCk7XHJcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSBuYW1lO1xyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gam9iO1xyXG4gIHByb2ZpbGVGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGVkaXRGb3JtTW9kYWwub3BlbigpO1xyXG59XHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvcGVuUHJvZmlsZU1vZGFsKTtcclxuYWRkTW9kYWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGFkZEZvcm1Nb2RhbC5vcGVuKCk7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gY2xvc2VQcm9maWxlTW9kYWwoKSB7XHJcbiAgZWRpdEZvcm1Nb2RhbC5jbG9zZSgpO1xyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX25hbWVFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2pvYkVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbC50ZXh0Q29udGVudCxcclxuICAgICAgam9iOiB0aGlzLl9qb2JFbC50ZXh0Q29udGVudCxcclxuICAgICAgYXZhdGFyOiB0aGlzLl9hdmF0YXJFTGVtZW50LFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHNldEF2YXRhckluZm8oYXZhdGFyKSB7XHJcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50LnNyYyA9IGF2YXRhcjtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgam9iIH0pIHtcclxuICAgIHRoaXMuX25hbWVFbC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9qb2JFbC50ZXh0Q29udGVudCA9IGpvYjtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3IgJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBnZXRBcHBJbmZvKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldFVzZXJJbmZvKCksIHRoaXMuaW5pdGlhbENhcmRzKCldKTtcclxuICB9XHJcblxyXG4gIGluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGVkaXRQcm9maWxlKHsgbmFtZSwgZGVzY3JpcHRpb24gfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IGRlc2NyaXB0aW9uLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBhZGROZXdDYXJkKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJwb3N0XCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lLFxyXG4gICAgICAgIGxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGNhcmRMaWtlcyhjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGNhcmRJRCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElEfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGFkZExpa2UoeyBfaWQgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7X2lkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIHJlbW92ZUxpa2UoeyBfaWQgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7X2lkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZVByb2ZpbGVQaWN0dXJlKGF2YXRhcikge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGF2YXRhciksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgLy8gb3RoZXIgbWV0aG9kcyBmb3Igd29ya2luZyB3aXRoIHRoZSBBUElcclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX2NvbmZpcm1CdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZV9fYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fc2F2ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2J1dHRvblwiKTtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZVN1Ym1pdCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX2NvbmZpcm1CdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fY29uZmlybUJ1dHRvbi50ZXh0Q29udGVudCA9IFwieWVzXCI7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRTdWJtaXRBY3Rpb24oYWN0aW9uKSB7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVTdWJtaXQgPSBhY3Rpb247XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5faW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwLWltYWdlXCIpO1xyXG4gICAgdGhpcy5fdGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXAtdGV4dFwiKTtcclxuICB9XHJcblxyXG4gIG9wZW4oeyBsaW5rLCBuYW1lIH0pIHtcclxuICAgIHRoaXMuX2ltYWdlLnNyYyA9IGxpbms7XHJcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSBuYW1lO1xyXG4gICAgdGhpcy5fdGV4dC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJGb3JtVmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJmb3JtRWxlbWVudCIsImNvbmZpZyIsInRoaXMiLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2VFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImlkIiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsInJlbW92ZSIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2NoZWNrRm9ybVZhbGlkaXR5IiwiX2lucHV0RWxlbWVudHMiLCJldmVyeSIsImlucHV0IiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX3N1Ym1pdEJ1dHRvbiIsImRpc2FibGVkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwicmVzZXRWYWxpZGF0aW9uIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiQ2FyZCIsIl9yZWYiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlUHJldmlld0ltYWdlIiwiaGFuZGxlTGlrZUNhcmQiLCJjdXJyZW50VXNlcklkIiwiaGFuZGxlRGVsZXRlQ2FyZCIsIm93bmVyIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2xpa2VzIiwibGlrZXMiLCJfaWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlTGlrZUNhcmQiLCJfY3VycmVudFVzZXJJZCIsIl9vd25lciIsIl9oYW5kbGVEZWxldGVDYXJkIiwiY29uc29sZSIsImxvZyIsIl9nZXRUZW1wbGF0ZSIsImRvY3VtZW50IiwiY29udGVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiY2xvbmVOb2RlIiwiZGVsZXRlQ2xpY2siLCJfZWxlbWVudCIsInVwZGF0ZUxpa2VzIiwicmVuZGVyTGlrZXMiLCJfY2FyZExpa2VzIiwibGVuZ3RoIiwiaXNMaWtlZCIsImxpa2VCdXR0b24iLCJzb21lIiwibGlrZSIsIl9jaGVja0lkRm9yRGVsZXRlIiwiYWRkVHJhc2giLCJyZW1vdmVUcmFzaCIsImNhcmRUcmFzaEJ1dHRvbiIsImNhcmRJbWFnZSIsImdlbmVyYXRlQ2FyZCIsImNhcmRUaXRsZSIsInNyYyIsImFsdCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwib3BlbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfbW9kYWxTYXZlQnV0dG9uIiwiX3NhdmVCdXR0b25UZXh0IiwiX2dldElucHV0VmFsdWUiLCJpbnB1dHMiLCJpbnB1dFZhbHVlcyIsInZhbHVlIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsInJlc2V0IiwiU2VjdGlvbiIsInNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJwcm9maWxlTW9kYWxCb3giLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVFZGl0Rm9ybSIsInByb2ZpbGVUaXRsZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJhZGRNb2RhbEJveCIsImFkZE1vZGFsQnV0dG9uIiwiYWRkTW9kYWxGb3JtIiwiYXZpRm9ybSIsImZvcm1WYWxpZGF0aW9uQ29uZmlnIiwidXNlckluZm9FbCIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfbmFtZUVsIiwiX2pvYkVsIiwiX2F2YXRhckVsZW1lbnQiLCJnZXRVc2VySW5mbyIsImpvYiIsImF2YXRhciIsIl9hdmF0YXJFTGVtZW50Iiwic2V0QXZhdGFySW5mbyIsInNldFVzZXJJbmZvIiwiX3JlZjIiLCJhcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJmZXRjaCIsIm1ldGhvZCIsInRoZW4iLCJnZXRBcHBJbmZvIiwiYWxsIiwiaW5pdGlhbENhcmRzIiwiZWRpdFByb2ZpbGUiLCJkZXNjcmlwdGlvbiIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJhZGROZXdDYXJkIiwiX3JlZjMiLCJjYXJkTGlrZXMiLCJjYXJkSWQiLCJkZWxldGVDYXJkIiwiY2FyZElEIiwiYWRkTGlrZSIsIl9yZWY0IiwicmVtb3ZlTGlrZSIsIl9yZWY1IiwidXBkYXRlUHJvZmlsZVBpY3R1cmUiLCJhdXRob3JpemF0aW9uIiwic2VjdGlvbkVsIiwiY3JlYXRlQ2FyZCIsImNhcmQiLCJpbWFnZVBvcHVwIiwic2hvdWxkUmVtb3ZlTGlrZSIsImNhdGNoIiwiZXJyIiwiZGVsZXRlUG9wdXAiLCJzZXRTdWJtaXRBY3Rpb24iLCJmaW5hbGx5IiwidXNlckRhdGEiLCJjYXJkRGF0YSIsImFkZEZvcm1WYWxpZGF0b3IiLCJwcm9maWxlRm9ybVZhbGlkYXRvciIsImF2aUZvcm1WYWxpZGF0b3IiLCJfY29uZmlybUJ1dHRvbiIsIl9zYXZlQnV0dG9uIiwiX2hhbmRsZURlbGV0ZVN1Ym1pdCIsImFjdGlvbiIsImVkaXRGb3JtTW9kYWwiLCJQb3B1cFdpdGhGb3JtIiwiYWRkRm9ybU1vZGFsIiwidXBkYXRlUHJvZmlsZUZvcm0iLCJfaW1hZ2UiLCJfdGV4dCJdLCJzb3VyY2VSb290IjoiIn0=