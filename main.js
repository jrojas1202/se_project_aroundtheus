!function(){"use strict";class e{constructor(e,t){this._formElement=e,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_checkFormValidity=()=>this._inputElements.every((e=>e.validity.valid));_toggleButtonState(){this._checkFormValidity()?(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1):(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0)}_setEventListeners(){this._inputElements=[...this._formElement.querySelectorAll(this._inputSelector)],this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState(this._inputElements,this._submitButton)}))}))}resetValidation(){this._toggleButtonState(),this._inputElements.forEach((e=>{this._hideInputError(e)}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners(this._formElement)}}class t{constructor(e){let{data:t,cardSelector:s,handlePreviewImage:r,handleLikeCard:n,currentUserId:i,handleDeleteCard:o,owner:a}=e;this._name=t.name,this._link=t.link,this._isLiked=!!t.isLiked,this._id=t._id,this._cardSelector=s,this._handleImageClick=r,this._handleLikeCard=n,this._currentUserId=i,this._owner=t.owner._id,this._handleDeleteCard=o,console.log(this._owner)}_getTemplate(){return document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0)}deleteClick(){this._element.remove()}updateLikes(e){this._isLiked=e,this.renderLikes()}renderLikes(){this.isLiked()?this.likeButton.classList.add("card__like-button_active"):this.likeButton.classList.remove("card__like-button_active")}isLiked(){return this._isLiked}_checkIdForDelete(){this._owner===this._currentUserId?this.addTrash():this.removeTrash()}addTrash(){this.cardTrashButton.classList.remove("card__trash-button_active")}removeTrash(){this.cardTrashButton.classList.add("card__trash-button_active")}_setEventListeners(){this.likeButton.addEventListener("click",(()=>this._handleLikeCard(this.isLiked()))),this.cardTrashButton.addEventListener("click",(()=>{this._handleDeleteCard(this._id)})),this.cardImage.addEventListener("click",(()=>{this._handleImageClick()}))}generateCard(){this._element=this._getTemplate(),this.likeButton=this._element.querySelector(".card__like-button"),this.cardTrashButton=this._element.querySelector(".card__trash-button"),this.cardImage=this._element.querySelector(".card__image");const e=this._element.querySelector(".card__title");return this.cardImage.src=this._link,this.cardImage.alt=this._name,e.textContent=this._name,this._cardLikes=this._element.querySelector(".card__likes-counter"),this.renderLikes(),this._setEventListeners(),this._checkIdForDelete(),this._element}}class s{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__closebutton"))&&this.close()}))}}var r=class extends s{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".popup__form"),this._handleFormSubmit=t,this._modalSaveButton=this._popupElement.querySelector(".popup__button"),this._saveButtonText=this._modalSaveButton.textContent}_getInputValue(){const e=this._popupForm.querySelectorAll(".popup__input"),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(()=>this._handleFormSubmit(this._getInputValue())))}renderLoading(e){this._modalSaveButton.textContent=e?"Saving...":this._saveButtonText}close(){this._popupForm.reset(),super.close()}};class n{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}const i=document.querySelector("#modal"),o=document.querySelector(".profile__edit-button"),a=(i.querySelector("#modal-closebutton"),i.querySelector("#modal-form")),l=document.querySelector("#popup-name"),c=document.querySelector("#popup-description"),d=document.querySelector("#add-popup"),h=document.querySelector(".profile__add-button"),u=d.querySelector("#add-popupform"),_=(document.querySelector("#preview-popup").querySelector("#popup-closebutton"),document.querySelector("#avi-popupform")),p={inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},m=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:r}=e;this._nameEl=document.querySelector(t),this._jobEl=document.querySelector(s),this._avatarElement=document.querySelector(r)}getUserInfo(){return{name:this._nameEl.textContent,job:this._jobEl.textContent,avatar:this._avatarELement}}setAvatarInfo(e){this._avatarElement.src=e}setUserInfo(e){let{name:t,job:s}=e;this._nameEl.textContent=t,this._jobEl.textContent=s}}({nameSelector:".profile__title",jobSelector:".profile__description",avatarSelector:".profile__image"}),v=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error ${e.status}`)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then(this._checkResponse)}getAppInfo(){return Promise.all([this.getUserInfo(),this.initialCards()])}initialCards(){return fetch(`${this._baseUrl}/cards`,{method:"GET",headers:this._headers}).then(this._checkResponse)}editProfile(e){let{name:t,description:s}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})}).then(this._checkResponse)}addNewCard(e){let{name:t,link:s}=e;return fetch(`${this._baseUrl}/cards`,{method:"post",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then(this._checkResponse)}cardLikes(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}addLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}removeLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}updateProfilePicture(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"92f7ebfa-9e8e-4fb8-b0a3-1cdaa15ccbe0","Content-Type":"application/json"}});let E,L;function b(e){const s=new t({data:e,cardSelector:"#card-template",currentUserId:L,handlePreviewImage:()=>{q.open(e)},handleLikeCard:t=>{t?v.removeLike(e._id).then((e=>{s.updateLikes(e.isLiked)})).catch((e=>{console.log(e)})):v.addLike(e._id).then((e=>{s.updateLikes(e.isLiked)})).catch((e=>{console.log(e)}))},handleDeleteCard:e=>{g.open(),g.setSubmitAction((()=>{g.renderLoading(!0),v.deleteCard(e).then((()=>{s.deleteClick(),g.close()})).catch((e=>{console.log(e)})).finally((()=>{g.renderLoading(!1)}))}))}});return s.generateCard()}v.getAppInfo().then((e=>{let[t,s]=e;L=t._id,m.setUserInfo({name:t.name,job:t.about}),m.setAvatarInfo(t.avatar),E=new n({items:s,renderer:e=>{const t=b(e);E.addItem(t)}},".cards__list"),E.renderItems()})).catch((e=>{console.log(e)}));const S=new e(u,p);S.enableValidation();const k=new e(a,p);k.enableValidation();const f=new e(_,p);f.enableValidation();const g=new class extends s{constructor(e){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".popup__form"),this._confirmButton=document.querySelector("#delete__button"),this._saveButton=document.querySelector(".popup__button")}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleDeleteSubmit()}))}renderLoading(e){this._confirmButton.textContent=e?"Saving...":"yes"}setSubmitAction(e){this._handleDeleteSubmit=e}}("#delete-popup");g.setEventListeners();const y=new r("#modal",(e=>{y.renderLoading(!0),v.editProfile(e).then((()=>{m.setUserInfo({name:e.name,job:e.description}),y.close()})).catch((e=>{console.log(e)})).finally((()=>{y.renderLoading(!1)}))}));y.setEventListeners();const C=new r("#add-popup",(e=>{C.renderLoading(!0),v.addNewCard(e).then((e=>{const t=b(e);E.addItem(t),C.close()})).catch((e=>{console.log(e)})).finally((()=>{C.renderLoading(!1)}))}));C.setEventListeners();const I=new r("#avi-popup",(e=>{I.renderLoading(!0),v.updateProfilePicture(e).then((e=>{m.setAvatarInfo(e.avatar),I.close()})).catch((e=>{console.log(e)})).finally((()=>{I.renderLoading(!1)}))}));I.setEventListeners(),document.querySelector(".profile__image").addEventListener("click",(()=>{I.open(),f.resetValidation()}));const q=new class extends s{constructor(e){super({popupSelector:e}),this._image=document.querySelector("#popup-image"),this._text=document.querySelector("#popup-text")}open(e){let{link:t,name:s}=e;this._image.src=t,this._image.alt=s,this._text.textContent=s,super.open()}}("#preview-popup");q.setEventListeners(),o.addEventListener("click",(function(){const{name:e,job:t}=m.getUserInfo();l.value=e,c.value=t,k.resetValidation(),y.open()})),h.addEventListener("click",(()=>{S.resetValidation(),C.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQWUsTUFBTUEsRUFDbkJDLFdBQUFBLENBQVlDLEVBQWFDLEdBQ3ZCQyxLQUFLQyxhQUFlSCxFQUNwQkUsS0FBS0UsZUFBaUJILEVBQU9JLGNBQzdCSCxLQUFLSSxzQkFBd0JMLEVBQU9NLHFCQUNwQ0wsS0FBS00scUJBQXVCUCxFQUFPUSxvQkFDbkNQLEtBQUtRLGlCQUFtQlQsRUFBT1UsZ0JBQy9CVCxLQUFLVSxZQUFjWCxFQUFPWSxVQUM1QixDQUVBQyxlQUFBQSxDQUFnQkMsR0FDZCxNQUFNQyxFQUFzQmQsS0FBS0MsYUFBYWMsY0FDM0MsSUFBR0YsRUFBYUcsWUFFbkJILEVBQWFJLFVBQVVDLElBQUlsQixLQUFLUSxrQkFDaENNLEVBQW9CSyxZQUFjTixFQUFhTyxrQkFDL0NOLEVBQW9CRyxVQUFVQyxJQUFJbEIsS0FBS1UsWUFDekMsQ0FFQVcsZUFBQUEsQ0FBZ0JSLEdBQ2QsTUFBTUMsRUFBc0JkLEtBQUtDLGFBQWFjLGNBQzNDLElBQUdGLEVBQWFHLFlBRW5CSCxFQUFhSSxVQUFVSyxPQUFPdEIsS0FBS1Esa0JBQ25DTSxFQUFvQkssWUFBYyxHQUNsQ0wsRUFBb0JHLFVBQVVLLE9BQU90QixLQUFLVSxZQUM1QyxDQUVBYSxtQkFBQUEsQ0FBb0JWLEdBQ2JBLEVBQWFXLFNBQVNDLE1BR3pCekIsS0FBS3FCLGdCQUFnQlIsR0FGckJiLEtBQUtZLGdCQUFnQkMsRUFJekIsQ0FFQWEsbUJBQXFCQSxJQUNuQjFCLEtBQUsyQixlQUFlQyxPQUFPQyxHQUFVQSxFQUFNTCxTQUFTQyxRQUV0REssa0JBQUFBLEdBQ2dCOUIsS0FBSzBCLHNCQUVqQjFCLEtBQUsrQixjQUFjZCxVQUFVSyxPQUFPdEIsS0FBS00sc0JBQ3pDTixLQUFLK0IsY0FBY0MsVUFBVyxJQUU5QmhDLEtBQUsrQixjQUFjZCxVQUFVQyxJQUFJbEIsS0FBS00sc0JBQ3RDTixLQUFLK0IsY0FBY0MsVUFBVyxFQWNsQyxDQUVBQyxrQkFBQUEsR0FDRWpDLEtBQUsyQixlQUFpQixJQUNqQjNCLEtBQUtDLGFBQWFpQyxpQkFBaUJsQyxLQUFLRSxpQkFFN0NGLEtBQUsrQixjQUFnQi9CLEtBQUtDLGFBQWFjLGNBQ3JDZixLQUFLSSx1QkFFUEosS0FBSzJCLGVBQWVRLFNBQVN0QixJQUMzQkEsRUFBYXVCLGlCQUFpQixTQUFTLEtBQ3JDcEMsS0FBS3VCLG9CQUFvQlYsR0FDekJiLEtBQUs4QixtQkFBbUI5QixLQUFLMkIsZUFBZ0IzQixLQUFLK0IsY0FBYyxHQUNoRSxHQUVOLENBRUFNLGVBQUFBLEdBQ0VyQyxLQUFLOEIscUJBQ0w5QixLQUFLMkIsZUFBZVEsU0FBU3RCLElBQzNCYixLQUFLcUIsZ0JBQWdCUixFQUFhLEdBRXRDLENBRUF5QixnQkFBQUEsR0FDRXRDLEtBQUtDLGFBQWFtQyxpQkFBaUIsVUFBV0csSUFDNUNBLEVBQUlDLGdCQUFnQixJQUV0QnhDLEtBQUtpQyxtQkFBbUJqQyxLQUFLQyxhQUMvQixFQ3pGYSxNQUFNd0MsRUFDbkI1QyxXQUFBQSxDQUFXNkMsR0FRUixJQVJTLEtBQ1ZDLEVBQUksYUFDSkMsRUFBWSxtQkFDWkMsRUFBa0IsZUFDbEJDLEVBQWMsY0FDZEMsRUFBYSxpQkFDYkMsRUFBZ0IsTUFDaEJDLEdBQ0RQLEVBQ0MxQyxLQUFLa0QsTUFBUVAsRUFBS1EsS0FDbEJuRCxLQUFLb0QsTUFBUVQsRUFBS1UsS0FDbEJyRCxLQUFLc0QsV0FBYVgsRUFBS1ksUUFDdkJ2RCxLQUFLd0QsSUFBTWIsRUFBS2EsSUFFaEJ4RCxLQUFLeUQsY0FBZ0JiLEVBQ3JCNUMsS0FBSzBELGtCQUFvQmIsRUFDekI3QyxLQUFLMkQsZ0JBQWtCYixFQUN2QjlDLEtBQUs0RCxlQUFpQmIsRUFDdEIvQyxLQUFLNkQsT0FBU2xCLEVBQUtNLE1BQU1PLElBQ3pCeEQsS0FBSzhELGtCQUFvQmQsRUFDekJlLFFBQVFDLElBQUloRSxLQUFLNkQsT0FDbkIsQ0FFQUksWUFBQUEsR0FJRSxPQUhvQkMsU0FDakJuRCxjQUFjZixLQUFLeUQsZUFDbkJVLFFBQVFDLGtCQUFrQkMsV0FBVSxFQUV6QyxDQUVBQyxXQUFBQSxHQUNFdEUsS0FBS3VFLFNBQVNqRCxRQUNoQixDQUVBa0QsV0FBQUEsQ0FBWWpCLEdBQ1Z2RCxLQUFLc0QsU0FBV0MsRUFDaEJ2RCxLQUFLeUUsYUFDUCxDQUVBQSxXQUFBQSxHQUVrQnpFLEtBQUt1RCxVQUVuQnZELEtBQUswRSxXQUFXekQsVUFBVUMsSUFBSSw0QkFFOUJsQixLQUFLMEUsV0FBV3pELFVBQVVLLE9BQU8sMkJBRXJDLENBRUFpQyxPQUFBQSxHQUNFLE9BQU92RCxLQUFLc0QsUUFDZCxDQUVBcUIsaUJBQUFBLEdBQ00zRSxLQUFLNkQsU0FBVzdELEtBQUs0RCxlQUN2QjVELEtBQUs0RSxXQUVMNUUsS0FBSzZFLGFBRVQsQ0FFQUQsUUFBQUEsR0FDRTVFLEtBQUs4RSxnQkFBZ0I3RCxVQUFVSyxPQUFPLDRCQUN4QyxDQUVBdUQsV0FBQUEsR0FDRTdFLEtBQUs4RSxnQkFBZ0I3RCxVQUFVQyxJQUFJLDRCQUNyQyxDQUVBZSxrQkFBQUEsR0FDRWpDLEtBQUswRSxXQUFXdEMsaUJBQWlCLFNBQVMsSUFDeENwQyxLQUFLMkQsZ0JBQWdCM0QsS0FBS3VELGFBRTVCdkQsS0FBSzhFLGdCQUFnQjFDLGlCQUFpQixTQUFTLEtBQzdDcEMsS0FBSzhELGtCQUFrQjlELEtBQUt3RCxJQUFJLElBRWxDeEQsS0FBSytFLFVBQVUzQyxpQkFBaUIsU0FBUyxLQUN2Q3BDLEtBQUswRCxtQkFBbUIsR0FFNUIsQ0FFQXNCLFlBQUFBLEdBQ0VoRixLQUFLdUUsU0FBV3ZFLEtBQUtpRSxlQUNyQmpFLEtBQUswRSxXQUFhMUUsS0FBS3VFLFNBQVN4RCxjQUFjLHNCQUM5Q2YsS0FBSzhFLGdCQUFrQjlFLEtBQUt1RSxTQUFTeEQsY0FBYyx1QkFDbkRmLEtBQUsrRSxVQUFZL0UsS0FBS3VFLFNBQVN4RCxjQUFjLGdCQUM3QyxNQUFNa0UsRUFBWWpGLEtBQUt1RSxTQUFTeEQsY0FBYyxnQkFROUMsT0FQQWYsS0FBSytFLFVBQVVHLElBQU1sRixLQUFLb0QsTUFDMUJwRCxLQUFLK0UsVUFBVUksSUFBTW5GLEtBQUtrRCxNQUMxQitCLEVBQVU5RCxZQUFjbkIsS0FBS2tELE1BQzdCbEQsS0FBS29GLFdBQWFwRixLQUFLdUUsU0FBU3hELGNBQWMsd0JBQzlDZixLQUFLeUUsY0FDTHpFLEtBQUtpQyxxQkFDTGpDLEtBQUsyRSxvQkFDRTNFLEtBQUt1RSxRQUNkLEVDaEdhLE1BQU1jLEVBQ25CeEYsV0FBQUEsQ0FBVzZDLEdBQW9CLElBQW5CLGNBQUU0QyxHQUFlNUMsRUFDM0IxQyxLQUFLdUYsY0FBZ0JyQixTQUFTbkQsY0FBY3VFLEdBQzVDdEYsS0FBS3dGLGdCQUFrQnhGLEtBQUt3RixnQkFBZ0JDLEtBQUt6RixLQUNuRCxDQUVBMEYsSUFBQUEsR0FDRTFGLEtBQUt1RixjQUFjdEUsVUFBVUMsSUFBSSxnQkFDakNnRCxTQUFTOUIsaUJBQWlCLFVBQVdwQyxLQUFLd0YsZ0JBQzVDLENBRUFHLEtBQUFBLEdBQ0UzRixLQUFLdUYsY0FBY3RFLFVBQVVLLE9BQU8sZ0JBQ3BDNEMsU0FBUzBCLG9CQUFvQixVQUFXNUYsS0FBS3dGLGdCQUMvQyxDQUVBQSxlQUFBQSxDQUFnQmpELEdBQ0UsV0FBWkEsRUFBSXNELEtBQ043RixLQUFLMkYsT0FFVCxDQUVBRyxpQkFBQUEsR0FDRTlGLEtBQUt1RixjQUFjbkQsaUJBQWlCLGFBQWNHLEtBRTlDQSxFQUFJd0QsT0FBTzlFLFVBQVUrRSxTQUFTLFVBQzlCekQsRUFBSXdELE9BQU85RSxVQUFVK0UsU0FBUyx3QkFFOUJoRyxLQUFLMkYsT0FDUCxHQUVKLEVDU0YsTUF2Q0EsY0FBNEJOLEVBQzFCeEYsV0FBQUEsQ0FBWXlGLEVBQWVXLEdBQ3pCQyxNQUFNLENBQUVaLGtCQUNSdEYsS0FBS21HLFdBQWFuRyxLQUFLdUYsY0FBY3hFLGNBQWMsZ0JBQ25EZixLQUFLb0csa0JBQW9CSCxFQUN6QmpHLEtBQUtxRyxpQkFBbUJyRyxLQUFLdUYsY0FBY3hFLGNBQWMsa0JBQ3pEZixLQUFLc0csZ0JBQWtCdEcsS0FBS3FHLGlCQUFpQmxGLFdBQy9DLENBRUFvRixjQUFBQSxHQUNFLE1BQU1DLEVBQVN4RyxLQUFLbUcsV0FBV2pFLGlCQUFpQixpQkFDMUN1RSxFQUFjLENBQUMsRUFJckIsT0FIQUQsRUFBT3JFLFNBQVNOLElBQ2Q0RSxFQUFZNUUsRUFBTXNCLE1BQVF0QixFQUFNNkUsS0FBSyxJQUVoQ0QsQ0FDVCxDQUVBWCxpQkFBQUEsR0FDRUksTUFBTUosb0JBQ045RixLQUFLbUcsV0FBVy9ELGlCQUFpQixVQUFVLElBQ3pDcEMsS0FBS29HLGtCQUFrQnBHLEtBQUt1RyxtQkFFaEMsQ0FFQUksYUFBQUEsQ0FBY0MsR0FFVjVHLEtBQUtxRyxpQkFBaUJsRixZQURwQnlGLEVBQ2tDLFlBRUE1RyxLQUFLc0csZUFFN0MsQ0FFQVgsS0FBQUEsR0FDRTNGLEtBQUttRyxXQUFXVSxRQUNoQlgsTUFBTVAsT0FDUixHQ3JDYSxNQUFNbUIsRUFDbkJqSCxXQUFBQSxDQUFXNkMsRUFBc0JxRSxHQUFVLElBQS9CLE1BQUVDLEVBQUssU0FBRUMsR0FBVXZFLEVBQzdCMUMsS0FBS2tILE9BQVNGLEVBQ2RoSCxLQUFLbUgsVUFBWUYsRUFDakJqSCxLQUFLb0gsV0FBYWxELFNBQVNuRCxjQUFjZ0csRUFDM0MsQ0FFQU0sV0FBQUEsR0FDRXJILEtBQUtrSCxPQUFPL0UsU0FBU21GLElBQ25CdEgsS0FBS21ILFVBQVVHLEVBQUssR0FFeEIsQ0FFQUMsT0FBQUEsQ0FBUUMsR0FDTnhILEtBQUtvSCxXQUFXSyxRQUFRRCxFQUMxQixFQ2ZGLE1BMkJNRSxFQUFrQnhELFNBQVNuRCxjQUFjLFVBQ3pDNEcsRUFBb0J6RCxTQUFTbkQsY0FBYyx5QkFHM0M2RyxHQURKRixFQUFnQjNHLGNBQWMsc0JBQ1IyRyxFQUFnQjNHLGNBQWMsZ0JBQ2hEOEcsRUFBb0IzRCxTQUFTbkQsY0FBYyxlQUMzQytHLEVBQTBCNUQsU0FBU25ELGNBQWMsc0JBQ2pEZ0gsRUFBYzdELFNBQVNuRCxjQUFjLGNBQ3JDaUgsRUFBaUI5RCxTQUFTbkQsY0FBYyx3QkFDeENrSCxFQUFlRixFQUFZaEgsY0FBYyxrQkFHekNtSCxHQUZtQmhFLFNBQVNuRCxjQUFjLGtCQUNOQSxjQUFjLHNCQUN4Q21ELFNBQVNuRCxjQUFjLG1CQUVqQ29ILEVBQXVCLENBQzNCaEksY0FBZSxnQkFDZkUscUJBQXNCLGlCQUN0QkUsb0JBQXFCLHlCQUNyQkUsZ0JBQWlCLDBCQUNqQkUsV0FBWSx3QkNwQlJ5SCxFQUFhLElDMUJKLE1BQ2J2SSxXQUFBQSxDQUFXNkMsR0FBZ0QsSUFBL0MsYUFBRTJGLEVBQVksWUFBRUMsRUFBVyxlQUFFQyxHQUFnQjdGLEVBQ3ZEMUMsS0FBS3dJLFFBQVV0RSxTQUFTbkQsY0FBY3NILEdBQ3RDckksS0FBS3lJLE9BQVN2RSxTQUFTbkQsY0FBY3VILEdBQ3JDdEksS0FBSzBJLGVBQWlCeEUsU0FBU25ELGNBQWN3SCxFQUMvQyxDQUVBSSxXQUFBQSxHQUNFLE1BQU8sQ0FDTHhGLEtBQU1uRCxLQUFLd0ksUUFBUXJILFlBQ25CeUgsSUFBSzVJLEtBQUt5SSxPQUFPdEgsWUFDakIwSCxPQUFRN0ksS0FBSzhJLGVBRWpCLENBRUFDLGFBQUFBLENBQWNGLEdBQ1o3SSxLQUFLMEksZUFBZXhELElBQU0yRCxDQUM1QixDQUVBRyxXQUFBQSxDQUFXQyxHQUFnQixJQUFmLEtBQUU5RixFQUFJLElBQUV5RixHQUFLSyxFQUN2QmpKLEtBQUt3SSxRQUFRckgsWUFBY2dDLEVBQzNCbkQsS0FBS3lJLE9BQU90SCxZQUFjeUgsQ0FDNUIsR0RJOEIsQ0FDOUJQLGFBQWMsa0JBQ2RDLFlBQWEsd0JBQ2JDLGVBQWdCLG9CQUlaVyxFQUFNLElFakNHLE1BQ2JySixXQUFBQSxDQUFXNkMsR0FBdUIsSUFBdEIsUUFBRXlHLEVBQU8sUUFBRUMsR0FBUzFHLEVBQzlCMUMsS0FBS3FKLFNBQVdGLEVBQ2hCbkosS0FBS3NKLFNBQVdGLENBQ2xCLENBRUFHLGNBQUFBLENBQWVDLEdBQ2IsT0FBSUEsRUFBSUMsR0FDQ0QsRUFBSUUsT0FFTkMsUUFBUUMsT0FBUSxTQUFRSixFQUFJSyxTQUNyQyxDQUVBbEIsV0FBQUEsR0FDRSxPQUFPbUIsTUFBTyxHQUFFOUosS0FBS3FKLG9CQUFxQixDQUN4Q1UsT0FBUSxNQUNSWCxRQUFTcEosS0FBS3NKLFdBQ2JVLEtBQUtoSyxLQUFLdUosZUFDZixDQUVBVSxVQUFBQSxHQUNFLE9BQU9OLFFBQVFPLElBQUksQ0FBQ2xLLEtBQUsySSxjQUFlM0ksS0FBS21LLGdCQUMvQyxDQUVBQSxZQUFBQSxHQUNFLE9BQU9MLE1BQU8sR0FBRTlKLEtBQUtxSixpQkFBa0IsQ0FDckNVLE9BQVEsTUFDUlgsUUFBU3BKLEtBQUtzSixXQUNiVSxLQUFLaEssS0FBS3VKLGVBQ2YsQ0FFQWEsV0FBQUEsQ0FBV25CLEdBQXdCLElBQXZCLEtBQUU5RixFQUFJLFlBQUVrSCxHQUFhcEIsRUFDL0IsT0FBT2EsTUFBTyxHQUFFOUosS0FBS3FKLG9CQUFxQixDQUN4Q1UsT0FBUSxRQUNSWCxRQUFTcEosS0FBS3NKLFNBQ2RnQixLQUFNQyxLQUFLQyxVQUFVLENBQ25CckgsS0FBTUEsRUFDTnNILE1BQU9KLE1BRVJMLEtBQUtoSyxLQUFLdUosZUFDZixDQUVBbUIsVUFBQUEsQ0FBVUMsR0FBaUIsSUFBaEIsS0FBRXhILEVBQUksS0FBRUUsR0FBTXNILEVBQ3ZCLE9BQU9iLE1BQU8sR0FBRTlKLEtBQUtxSixpQkFBa0IsQ0FDckNVLE9BQVEsT0FDUlgsUUFBU3BKLEtBQUtzSixTQUNkZ0IsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQnJILE9BQ0FFLFdBRUQyRyxLQUFLaEssS0FBS3VKLGVBQ2YsQ0FFQXFCLFNBQUFBLENBQVVDLEdBQ1IsT0FBT2YsTUFBTyxHQUFFOUosS0FBS3FKLGtCQUFrQndCLElBQVUsQ0FDL0NkLE9BQVEsTUFDUlgsUUFBU3BKLEtBQUtzSixXQUNiVSxLQUFLaEssS0FBS3VKLGVBQ2YsQ0FFQXVCLFVBQUFBLENBQVdDLEdBQ1QsT0FBT2pCLE1BQU8sR0FBRTlKLEtBQUtxSixrQkFBa0IwQixJQUFVLENBQy9DaEIsT0FBUSxTQUNSWCxRQUFTcEosS0FBS3NKLFdBQ2JVLEtBQUtoSyxLQUFLdUosZUFDZixDQUVBeUIsT0FBQUEsQ0FBUUgsR0FDTixPQUFPZixNQUFPLEdBQUU5SixLQUFLcUosa0JBQWtCd0IsVUFBZ0IsQ0FDckRkLE9BQVEsTUFDUlgsUUFBU3BKLEtBQUtzSixXQUNiVSxLQUFLaEssS0FBS3VKLGVBQ2YsQ0FFQTBCLFVBQUFBLENBQVdKLEdBQ1QsT0FBT2YsTUFBTyxHQUFFOUosS0FBS3FKLGtCQUFrQndCLFVBQWdCLENBQ3JEZCxPQUFRLFNBQ1JYLFFBQVNwSixLQUFLc0osV0FDYlUsS0FBS2hLLEtBQUt1SixlQUNmLENBQ0EyQixvQkFBQUEsQ0FBcUJyQyxHQUNuQixPQUFPaUIsTUFBTyxHQUFFOUosS0FBS3FKLDJCQUE0QixDQUMvQ1UsT0FBUSxRQUNSWCxRQUFTcEosS0FBS3NKLFNBQ2RnQixLQUFNQyxLQUFLQyxVQUFVM0IsS0FDcEJtQixLQUFLaEssS0FBS3VKLGVBQ2YsR0ZyRGtCLENBQ2xCSixRQUFTLGtEQUNUQyxRQUFTLENBQ1ArQixjQUFlLHVDQUNmLGVBQWdCLHNCQUdwQixJQUFJQyxFQUNBckksRUF5QkosU0FBU3NJLEVBQVcxSSxHQUNsQixNQUFNMkksRUFBTyxJQUFJN0ksRUFBSyxDQUNwQkUsT0FDQUMsYUFBYyxpQkFDZEcsZ0JBQ0FGLG1CQUFvQkEsS0FDbEIwSSxFQUFXN0YsS0FBSy9DLEVBQUssRUFFdkJHLGVBQWlCMEksSUFDWEEsRUFDRnRDLEVBQ0crQixXQUFXdEksRUFBS2EsS0FDaEJ3RyxNQUFNckgsSUFDTDJJLEVBQUs5RyxZQUFZN0IsRUFBS1ksUUFBUSxJQUUvQmtJLE9BQU9DLElBQ04zSCxRQUFRQyxJQUFJMEgsRUFBSSxJQUdwQnhDLEVBQ0c4QixRQUFRckksRUFBS2EsS0FDYndHLE1BQU1ySCxJQUNMMkksRUFBSzlHLFlBQVk3QixFQUFLWSxRQUFRLElBRS9Ca0ksT0FBT0MsSUFDTjNILFFBQVFDLElBQUkwSCxFQUFJLEdBRXRCLEVBRUYxSSxpQkFBbUI2SCxJQUNqQmMsRUFBWWpHLE9BQ1ppRyxFQUFZQyxpQkFBZ0IsS0FDMUJELEVBQVloRixlQUFjLEdBQzFCdUMsRUFDRzRCLFdBQVdELEdBQ1hiLE1BQUssS0FDSnNCLEVBQUtoSCxjQUNMcUgsRUFBWWhHLE9BQU8sSUFFcEI4RixPQUFPQyxJQUNOM0gsUUFBUUMsSUFBSTBILEVBQUksSUFFakJHLFNBQVEsS0FDUEYsRUFBWWhGLGVBQWMsRUFBTSxHQUNoQyxHQUNKLElBR04sT0FBTzJFLEVBQUt0RyxjQUNkLENBekVBa0UsRUFDR2UsYUFDQUQsTUFBS3RILElBQTBCLElBQXhCb0osRUFBVUMsR0FBU3JKLEVBQ3pCSyxFQUFnQitJLEVBQVN0SSxJQUN6QjRFLEVBQVdZLFlBQVksQ0FBRTdGLEtBQU0ySSxFQUFTM0ksS0FBTXlGLElBQUtrRCxFQUFTckIsUUFDNURyQyxFQUFXVyxjQUFjK0MsRUFBU2pELFFBRWxDdUMsRUFBWSxJQUFJdEUsRUFDZCxDQUNFRSxNQUFPK0UsRUFFUDlFLFNBQVd0RSxJQUNULE1BQU0ySSxFQUFPRCxFQUFXMUksR0FDeEJ5SSxFQUFVN0QsUUFBUStELEVBQUssR0FHM0IsZ0JBRUZGLEVBQVUvRCxhQUFhLElBRXhCb0UsT0FBT0MsSUFDTjNILFFBQVFDLElBQUkwSCxFQUFJLElBc0RwQixNQUFNTSxFQUFtQixJQUFJcE0sRUFBY3FJLEVBQWNFLEdBQ3pENkQsRUFBaUIxSixtQkFFakIsTUFBTTJKLEVBQXVCLElBQUlyTSxFQUMvQmdJLEVBQ0FPLEdBRUY4RCxFQUFxQjNKLG1CQUVyQixNQUFNNEosRUFBbUIsSUFBSXRNLEVBQWNzSSxFQUFTQyxHQUNwRCtELEVBQWlCNUosbUJBRWpCLE1BQU1xSixFQUFjLElHL0hMLGNBQW9DdEcsRUFDakR4RixXQUFBQSxDQUFZeUYsR0FDVlksTUFBTSxDQUFFWixrQkFDUnRGLEtBQUttRyxXQUFhbkcsS0FBS3VGLGNBQWN4RSxjQUFjLGdCQUNuRGYsS0FBS21NLGVBQWlCakksU0FBU25ELGNBQWMsbUJBQzdDZixLQUFLb00sWUFBY2xJLFNBQVNuRCxjQUFjLGlCQUM1QyxDQUVBK0UsaUJBQUFBLEdBQ0VJLE1BQU1KLG9CQUNOOUYsS0FBS21HLFdBQVcvRCxpQkFBaUIsVUFBV0csSUFDMUNBLEVBQUlDLGlCQUNKeEMsS0FBS3FNLHFCQUFxQixHQUU5QixDQUNBMUYsYUFBQUEsQ0FBY0MsR0FFVjVHLEtBQUttTSxlQUFlaEwsWUFEbEJ5RixFQUNnQyxZQUVBLEtBRXRDLENBRUFnRixlQUFBQSxDQUFnQlUsR0FDZHRNLEtBQUtxTSxvQkFBc0JDLENBQzdCLEdIc0c0QyxpQkFDOUNYLEVBQVk3RixvQkFFWixNQUFNeUcsRUFBZ0IsSUFBSUMsRUFBYyxVQUFXL0YsSUFDakQ4RixFQUFjNUYsZUFBYyxHQUM1QnVDLEVBQ0drQixZQUFZM0QsR0FDWnVELE1BQUssS0FDSjVCLEVBQVdZLFlBQVksQ0FDckI3RixLQUFNc0QsRUFBWXRELEtBQ2xCeUYsSUFBS25DLEVBQVk0RCxjQUVuQmtDLEVBQWM1RyxPQUFPLElBRXRCOEYsT0FBT0MsSUFDTjNILFFBQVFDLElBQUkwSCxFQUFJLElBRWpCRyxTQUFRLEtBQ1BVLEVBQWM1RixlQUFjLEVBQU0sR0FDbEMsSUFFTjRGLEVBQWN6RyxvQkFFZCxNQUFNMkcsRUFBZSxJQUFJRCxFQUFjLGNBQWUvRixJQUNwRGdHLEVBQWE5RixlQUFjLEdBQzNCdUMsRUFDR3dCLFdBQVdqRSxHQUNYdUQsTUFBTXJILElBQ0wsTUFBTTJJLEVBQU9ELEVBQVcxSSxHQUN4QnlJLEVBQVU3RCxRQUFRK0QsR0FDbEJtQixFQUFhOUcsT0FBTyxJQUVyQjhGLE9BQU9DLElBQ04zSCxRQUFRQyxJQUFJMEgsRUFBSSxJQUVqQkcsU0FBUSxLQUNQWSxFQUFhOUYsZUFBYyxFQUFNLEdBQ2pDLElBRU44RixFQUFhM0csb0JBRWIsTUFBTTRHLEVBQW9CLElBQUlGLEVBQWMsY0FBZS9GLElBQ3pEaUcsRUFBa0IvRixlQUFjLEdBQ2hDdUMsRUFDR2dDLHFCQUFxQnpFLEdBQ3JCdUQsTUFBTXRELElBQ0wwQixFQUFXVyxjQUFjckMsRUFBTW1DLFFBQy9CNkQsRUFBa0IvRyxPQUFPLElBRTFCOEYsT0FBT0MsSUFDTjNILFFBQVFDLElBQUkwSCxFQUFJLElBRWpCRyxTQUFRLEtBQ1BhLEVBQWtCL0YsZUFBYyxFQUFNLEdBQ3RDLElBRU4rRixFQUFrQjVHLG9CQUVFNUIsU0FBU25ELGNBQWMsbUJBQy9CcUIsaUJBQWlCLFNBQVMsS0FDcENzSyxFQUFrQmhILE9BQ2xCd0csRUFBaUI3SixpQkFBaUIsSUFHcEMsTUFBTWtKLEVBQWEsSUkvTEosY0FBNkJsRyxFQUMxQ3hGLFdBQUFBLENBQVl5RixHQUNWWSxNQUFNLENBQUVaLGtCQUNSdEYsS0FBSzJNLE9BQVN6SSxTQUFTbkQsY0FBYyxnQkFDckNmLEtBQUs0TSxNQUFRMUksU0FBU25ELGNBQWMsY0FDdEMsQ0FFQTJFLElBQUFBLENBQUloRCxHQUFpQixJQUFoQixLQUFFVyxFQUFJLEtBQUVGLEdBQU1ULEVBQ2pCMUMsS0FBSzJNLE9BQU96SCxJQUFNN0IsRUFDbEJyRCxLQUFLMk0sT0FBT3hILElBQU1oQyxFQUNsQm5ELEtBQUs0TSxNQUFNekwsWUFBY2dDLEVBQ3pCK0MsTUFBTVIsTUFDUixHSm1Mb0Msa0JBQ3RDNkYsRUFBV3pGLG9CQVNYNkIsRUFBa0J2RixpQkFBaUIsU0FQbkMsV0FDRSxNQUFNLEtBQUVlLEVBQUksSUFBRXlGLEdBQVFSLEVBQVdPLGNBQ2pDZCxFQUFrQm5CLE1BQVF2RCxFQUMxQjJFLEVBQXdCcEIsTUFBUWtDLEVBQ2hDcUQsRUFBcUI1SixrQkFDckJrSyxFQUFjN0csTUFDaEIsSUFFQXNDLEVBQWU1RixpQkFBaUIsU0FBUyxLQUN2QzRKLEVBQWlCM0osa0JBQ2pCb0ssRUFBYS9HLE1BQU0sRyIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL3V0aWxzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBDb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3IoZm9ybUVsZW1lbnQsIGNvbmZpZykge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBjb25maWcuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gY29uZmlnLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcztcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfY2hlY2tGb3JtVmFsaWRpdHkgPSAoKSA9PlxyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5ldmVyeSgoaW5wdXQpID0+IGlucHV0LnZhbGlkaXR5LnZhbGlkKTtcclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgY29uc3QgdmFsaWQgPSB0aGlzLl9jaGVja0Zvcm1WYWxpZGl0eSgpO1xyXG4gICAgaWYgKHZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vXHJcbiAgICAvLyBjb25zdCBpc1ZhbGlkID0gdGhpcy5pbnB1dEVsZW1lbnRzLnNvbWUoKGlucHV0RWxlbWVudCk9PiB7XHJcbiAgICAvLyAgICAgcmV0dXJuIGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZFxyXG4gICAgLy8gfSlcclxuICAgIC8vIGlmIChpc1ZhbGlkKSB7XHJcbiAgICAvLyAgICAgc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAvLyAgICAgc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIC8vICAgfSBlbHNlIHtcclxuICAgIC8vICAgICBzdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIC8vICAgICBzdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIC8vICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IFtcclxuICAgICAgLi4udGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSxcclxuICAgIF07XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICAgKTtcclxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKHRoaXMuX2lucHV0RWxlbWVudHMsIHRoaXMuX3N1Ym1pdEJ1dHRvbik7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnModGhpcy5fZm9ybUVsZW1lbnQpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3Rvcih7XHJcbiAgICBkYXRhLFxyXG4gICAgY2FyZFNlbGVjdG9yLFxyXG4gICAgaGFuZGxlUHJldmlld0ltYWdlLFxyXG4gICAgaGFuZGxlTGlrZUNhcmQsXHJcbiAgICBjdXJyZW50VXNlcklkLFxyXG4gICAgaGFuZGxlRGVsZXRlQ2FyZCxcclxuICAgIG93bmVyLFxyXG4gIH0pIHtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5faXNMaWtlZCA9ICEhZGF0YS5pc0xpa2VkO1xyXG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcclxuXHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlUHJldmlld0ltYWdlO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZUNhcmQgPSBoYW5kbGVMaWtlQ2FyZDtcclxuICAgIHRoaXMuX2N1cnJlbnRVc2VySWQgPSBjdXJyZW50VXNlcklkO1xyXG4gICAgdGhpcy5fb3duZXIgPSBkYXRhLm93bmVyLl9pZDtcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQgPSBoYW5kbGVEZWxldGVDYXJkO1xyXG4gICAgY29uc29sZS5sb2codGhpcy5fb3duZXIpO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkLmNsb25lTm9kZSh0cnVlKTtcclxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNsaWNrKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUxpa2VzKGlzTGlrZWQpIHtcclxuICAgIHRoaXMuX2lzTGlrZWQgPSBpc0xpa2VkO1xyXG4gICAgdGhpcy5yZW5kZXJMaWtlcygpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyTGlrZXMoKSB7XHJcbiAgICAvLyB0aGlzLl9jYXJkTGlrZXMudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XHJcbiAgICBjb25zdCBpc0xpa2VkID0gdGhpcy5pc0xpa2VkKCk7XHJcbiAgICBpZiAoaXNMaWtlZCkge1xyXG4gICAgICB0aGlzLmxpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMubGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgaXNMaWtlZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pc0xpa2VkO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSWRGb3JEZWxldGUoKSB7XHJcbiAgICBpZiAodGhpcy5fb3duZXIgPT09IHRoaXMuX2N1cnJlbnRVc2VySWQpIHtcclxuICAgICAgdGhpcy5hZGRUcmFzaCgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5yZW1vdmVUcmFzaCgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYWRkVHJhc2goKSB7XHJcbiAgICB0aGlzLmNhcmRUcmFzaEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fdHJhc2gtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICB9XHJcblxyXG4gIHJlbW92ZVRyYXNoKCkge1xyXG4gICAgdGhpcy5jYXJkVHJhc2hCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX3RyYXNoLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLmxpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDYXJkKHRoaXMuaXNMaWtlZCgpKVxyXG4gICAgKTtcclxuICAgIHRoaXMuY2FyZFRyYXNoQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQodGhpcy5faWQpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLmNhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5jYXJkVHJhc2hCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdHJhc2gtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5jYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICBjb25zdCBjYXJkVGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcbiAgICB0aGlzLmNhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcclxuICAgIGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9jYXJkTGlrZXMgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZXMtY291bnRlclwiKTtcclxuICAgIHRoaXMucmVuZGVyTGlrZXMoKTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9jaGVja0lkRm9yRGVsZXRlKCk7XHJcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cFwiKSB8fFxyXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfX2Nsb3NlYnV0dG9uXCIpXHJcbiAgICAgICkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5jbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9tb2RhbFNhdmVCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fc2F2ZUJ1dHRvblRleHQgPSB0aGlzLl9tb2RhbFNhdmVCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZSgpIHtcclxuICAgIGNvbnN0IGlucHV0cyA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19pbnB1dFwiKTtcclxuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XHJcbiAgICBpbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlKCkpXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcpIHtcclxuICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fbW9kYWxTYXZlQnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX21vZGFsU2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3NhdmVCdXR0b25UZXh0O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhGb3JtO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBzZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3lvc2VtaXRlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQmFsZCBtb3VudGFpbnNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGF0ZW1hci5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3Zhbm9pc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhZ28uanBnXCIsXHJcbiAgfSxcclxuXTtcclxuXHJcbmNvbnN0IHByb2ZpbGVNb2RhbEJveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWxcIik7XHJcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcclxuY29uc3QgcHJvZmlsZU1vZGFsQ2xvc2VCdXR0b24gPVxyXG4gIHByb2ZpbGVNb2RhbEJveC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWNsb3NlYnV0dG9uXCIpO1xyXG5jb25zdCBwcm9maWxlRWRpdEZvcm0gPSBwcm9maWxlTW9kYWxCb3gucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1mb3JtXCIpO1xyXG5jb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXAtbmFtZVwiKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwLWRlc2NyaXB0aW9uXCIpO1xyXG5jb25zdCBhZGRNb2RhbEJveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLXBvcHVwXCIpO1xyXG5jb25zdCBhZGRNb2RhbEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuY29uc3QgYWRkTW9kYWxGb3JtID0gYWRkTW9kYWxCb3gucXVlcnlTZWxlY3RvcihcIiNhZGQtcG9wdXBmb3JtXCIpO1xyXG5jb25zdCBpbWFnZU1vZGFsV2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LXBvcHVwXCIpO1xyXG5jb25zdCBpbWFnZUNsb3NlQnV0dG9uID0gaW1hZ2VNb2RhbFdpbmRvdy5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwLWNsb3NlYnV0dG9uXCIpO1xyXG5jb25zdCBhdmlGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmktcG9wdXBmb3JtXCIpO1xyXG5cclxuY29uc3QgZm9ybVZhbGlkYXRpb25Db25maWcgPSB7XHJcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcInBvcHVwX19lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcbmV4cG9ydCBmdW5jdGlvbiBoYW5kbGVPdmVybGF5Q2xvc2UoZXZ0KSB7XHJcbiAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBcIikpIHtcclxuICAgIGNsb3NlTW9kYWwoZXZ0LnRhcmdldCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaGFuZGxlRXNjVXAoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgIGNvbnN0IG9wZW5Qb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgY2xvc2VNb2RhbChvcGVuUG9wdXApO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xyXG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBoYW5kbGVPdmVybGF5Q2xvc2UpO1xyXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCBoYW5kbGVFc2NVcCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjbG9zZU1vZGFsKG1vZGFsKSB7XHJcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKTtcclxuICBtb2RhbC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGhhbmRsZU92ZXJsYXlDbG9zZSk7XHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGhhbmRsZUVzY1VwKTtcclxufVxyXG5cclxuZXhwb3J0IHtcclxuICBmb3JtVmFsaWRhdGlvbkNvbmZpZyxcclxuICBpbWFnZUNsb3NlQnV0dG9uLFxyXG4gIGltYWdlTW9kYWxXaW5kb3csXHJcbiAgYWRkTW9kYWxGb3JtLFxyXG4gIGFkZE1vZGFsQnV0dG9uLFxyXG4gIGFkZE1vZGFsQm94LFxyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LFxyXG4gIHByb2ZpbGVUaXRsZUlucHV0LFxyXG4gIHByb2ZpbGVFZGl0Rm9ybSxcclxuICBwcm9maWxlTW9kYWxDbG9zZUJ1dHRvbixcclxuICBwcm9maWxlRWRpdEJ1dHRvbixcclxuICBwcm9maWxlTW9kYWxCb3gsXHJcbiAgYXZpRm9ybSxcclxufTtcclxuIiwiaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCBQb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cC5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwQ29uZmlybWF0aW9uLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgZm9ybVZhbGlkYXRpb25Db25maWcsXHJcbiAgaW1hZ2VDbG9zZUJ1dHRvbixcclxuICBpbWFnZU1vZGFsV2luZG93LFxyXG4gIGFkZE1vZGFsRm9ybSxcclxuICBhZGRNb2RhbEJ1dHRvbixcclxuICBhZGRNb2RhbEJveCxcclxuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCxcclxuICBwcm9maWxlVGl0bGVJbnB1dCxcclxuICBwcm9maWxlRWRpdEZvcm0sXHJcbiAgcHJvZmlsZU1vZGFsQ2xvc2VCdXR0b24sXHJcbiAgcHJvZmlsZUVkaXRCdXR0b24sXHJcbiAgcHJvZmlsZU1vZGFsQm94LFxyXG4gIGF2aUZvcm0sXHJcbn0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzLmpzXCI7XHJcblxyXG5jb25zdCB1c2VySW5mb0VsID0gbmV3IFVzZXJJbmZvKHtcclxuICBuYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXHJcbiAgam9iU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXHJcbiAgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXHJcbn0pO1xyXG5cclxuLyotLS0tLS0tLS0tIEFQSSAtLS0tLS0tLS0tKi9cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiOTJmN2ViZmEtOWU4ZS00ZmI4LWIwYTMtMWNkYWExNWNjYmUwXCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxubGV0IHNlY3Rpb25FbDtcclxubGV0IGN1cnJlbnRVc2VySWQ7XHJcbmFwaVxyXG4gIC5nZXRBcHBJbmZvKClcclxuICAudGhlbigoW3VzZXJEYXRhLCBjYXJkRGF0YV0pID0+IHtcclxuICAgIGN1cnJlbnRVc2VySWQgPSB1c2VyRGF0YS5faWQ7XHJcbiAgICB1c2VySW5mb0VsLnNldFVzZXJJbmZvKHsgbmFtZTogdXNlckRhdGEubmFtZSwgam9iOiB1c2VyRGF0YS5hYm91dCB9KTtcclxuICAgIHVzZXJJbmZvRWwuc2V0QXZhdGFySW5mbyh1c2VyRGF0YS5hdmF0YXIpO1xyXG5cclxuICAgIHNlY3Rpb25FbCA9IG5ldyBTZWN0aW9uKFxyXG4gICAgICB7XHJcbiAgICAgICAgaXRlbXM6IGNhcmREYXRhLFxyXG5cclxuICAgICAgICByZW5kZXJlcjogKGRhdGEpID0+IHtcclxuICAgICAgICAgIGNvbnN0IGNhcmQgPSBjcmVhdGVDYXJkKGRhdGEpO1xyXG4gICAgICAgICAgc2VjdGlvbkVsLmFkZEl0ZW0oY2FyZCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgfSxcclxuICAgICAgXCIuY2FyZHNfX2xpc3RcIlxyXG4gICAgKTtcclxuICAgIHNlY3Rpb25FbC5yZW5kZXJJdGVtcygpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgfSk7XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGRhdGEpIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoe1xyXG4gICAgZGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcjogXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gICAgY3VycmVudFVzZXJJZCxcclxuICAgIGhhbmRsZVByZXZpZXdJbWFnZTogKCkgPT4ge1xyXG4gICAgICBpbWFnZVBvcHVwLm9wZW4oZGF0YSk7XHJcbiAgICB9LFxyXG4gICAgaGFuZGxlTGlrZUNhcmQ6IChzaG91bGRSZW1vdmVMaWtlKSA9PiB7XHJcbiAgICAgIGlmIChzaG91bGRSZW1vdmVMaWtlKSB7XHJcbiAgICAgICAgYXBpXHJcbiAgICAgICAgICAucmVtb3ZlTGlrZShkYXRhLl9pZClcclxuICAgICAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgIGNhcmQudXBkYXRlTGlrZXMoZGF0YS5pc0xpa2VkKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYXBpXHJcbiAgICAgICAgICAuYWRkTGlrZShkYXRhLl9pZClcclxuICAgICAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgIGNhcmQudXBkYXRlTGlrZXMoZGF0YS5pc0xpa2VkKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcbiAgICBoYW5kbGVEZWxldGVDYXJkOiAoY2FyZElkKSA9PiB7XHJcbiAgICAgIGRlbGV0ZVBvcHVwLm9wZW4oKTtcclxuICAgICAgZGVsZXRlUG9wdXAuc2V0U3VibWl0QWN0aW9uKCgpID0+IHtcclxuICAgICAgICBkZWxldGVQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLmRlbGV0ZUNhcmQoY2FyZElkKVxyXG4gICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBjYXJkLmRlbGV0ZUNsaWNrKCk7XHJcbiAgICAgICAgICAgIGRlbGV0ZVBvcHVwLmNsb3NlKCk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgICAgIGRlbGV0ZVBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuICB9KTtcclxuICByZXR1cm4gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxufVxyXG5cclxuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGFkZE1vZGFsRm9ybSwgZm9ybVZhbGlkYXRpb25Db25maWcpO1xyXG5hZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgcHJvZmlsZUVkaXRGb3JtLFxyXG4gIGZvcm1WYWxpZGF0aW9uQ29uZmlnXHJcbik7XHJcbnByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmNvbnN0IGF2aUZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihhdmlGb3JtLCBmb3JtVmFsaWRhdGlvbkNvbmZpZyk7XHJcbmF2aUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgZGVsZXRlUG9wdXAgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKFwiI2RlbGV0ZS1wb3B1cFwiKTtcclxuZGVsZXRlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGVkaXRGb3JtTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNtb2RhbFwiLCAoaW5wdXRWYWx1ZXMpID0+IHtcclxuICBlZGl0Rm9ybU1vZGFsLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAuZWRpdFByb2ZpbGUoaW5wdXRWYWx1ZXMpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvRWwuc2V0VXNlckluZm8oe1xyXG4gICAgICAgIG5hbWU6IGlucHV0VmFsdWVzLm5hbWUsXHJcbiAgICAgICAgam9iOiBpbnB1dFZhbHVlcy5kZXNjcmlwdGlvbixcclxuICAgICAgfSk7XHJcbiAgICAgIGVkaXRGb3JtTW9kYWwuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgZWRpdEZvcm1Nb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59KTtcclxuZWRpdEZvcm1Nb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgYWRkRm9ybU1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjYWRkLXBvcHVwXCIsIChpbnB1dFZhbHVlcykgPT4ge1xyXG4gIGFkZEZvcm1Nb2RhbC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmFkZE5ld0NhcmQoaW5wdXRWYWx1ZXMpXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChkYXRhKTtcclxuICAgICAgc2VjdGlvbkVsLmFkZEl0ZW0oY2FyZCk7XHJcbiAgICAgIGFkZEZvcm1Nb2RhbC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBhZGRGb3JtTW9kYWwucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufSk7XHJcbmFkZEZvcm1Nb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgdXBkYXRlUHJvZmlsZUZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNhdmktcG9wdXBcIiwgKGlucHV0VmFsdWVzKSA9PiB7XHJcbiAgdXBkYXRlUHJvZmlsZUZvcm0ucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuICBhcGlcclxuICAgIC51cGRhdGVQcm9maWxlUGljdHVyZShpbnB1dFZhbHVlcylcclxuICAgIC50aGVuKCh2YWx1ZSkgPT4ge1xyXG4gICAgICB1c2VySW5mb0VsLnNldEF2YXRhckluZm8odmFsdWUuYXZhdGFyKTtcclxuICAgICAgdXBkYXRlUHJvZmlsZUZvcm0uY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgdXBkYXRlUHJvZmlsZUZvcm0ucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufSk7XHJcbnVwZGF0ZVByb2ZpbGVGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBwcm9maWxlRWRpdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VcIik7XHJcbnByb2ZpbGVFZGl0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgdXBkYXRlUHJvZmlsZUZvcm0ub3BlbigpO1xyXG4gIGF2aUZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pO1xyXG5cclxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNwcmV2aWV3LXBvcHVwXCIpO1xyXG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5mdW5jdGlvbiBvcGVuUHJvZmlsZU1vZGFsKCkge1xyXG4gIGNvbnN0IHsgbmFtZSwgam9iIH0gPSB1c2VySW5mb0VsLmdldFVzZXJJbmZvKCk7XHJcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSBuYW1lO1xyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gam9iO1xyXG4gIHByb2ZpbGVGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGVkaXRGb3JtTW9kYWwub3BlbigpO1xyXG59XHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvcGVuUHJvZmlsZU1vZGFsKTtcclxuYWRkTW9kYWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGFkZEZvcm1Nb2RhbC5vcGVuKCk7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gY2xvc2VQcm9maWxlTW9kYWwoKSB7XHJcbiAgZWRpdEZvcm1Nb2RhbC5jbG9zZSgpO1xyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX25hbWVFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2pvYkVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbC50ZXh0Q29udGVudCxcclxuICAgICAgam9iOiB0aGlzLl9qb2JFbC50ZXh0Q29udGVudCxcclxuICAgICAgYXZhdGFyOiB0aGlzLl9hdmF0YXJFTGVtZW50LFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHNldEF2YXRhckluZm8oYXZhdGFyKSB7XHJcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50LnNyYyA9IGF2YXRhcjtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgam9iIH0pIHtcclxuICAgIHRoaXMuX25hbWVFbC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9qb2JFbC50ZXh0Q29udGVudCA9IGpvYjtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3IgJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBnZXRBcHBJbmZvKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldFVzZXJJbmZvKCksIHRoaXMuaW5pdGlhbENhcmRzKCldKTtcclxuICB9XHJcblxyXG4gIGluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGVkaXRQcm9maWxlKHsgbmFtZSwgZGVzY3JpcHRpb24gfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IGRlc2NyaXB0aW9uLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBhZGROZXdDYXJkKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJwb3N0XCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lLFxyXG4gICAgICAgIGxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGNhcmRMaWtlcyhjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGNhcmRJRCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElEfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGFkZExpa2UoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlTGlrZShjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG4gIHVwZGF0ZVByb2ZpbGVQaWN0dXJlKGF2YXRhcikge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGF2YXRhciksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgLy8gb3RoZXIgbWV0aG9kcyBmb3Igd29ya2luZyB3aXRoIHRoZSBBUElcclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX2NvbmZpcm1CdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZV9fYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fc2F2ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2J1dHRvblwiKTtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZVN1Ym1pdCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX2NvbmZpcm1CdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fY29uZmlybUJ1dHRvbi50ZXh0Q29udGVudCA9IFwieWVzXCI7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRTdWJtaXRBY3Rpb24oYWN0aW9uKSB7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVTdWJtaXQgPSBhY3Rpb247XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5faW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwLWltYWdlXCIpO1xyXG4gICAgdGhpcy5fdGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXAtdGV4dFwiKTtcclxuICB9XHJcblxyXG4gIG9wZW4oeyBsaW5rLCBuYW1lIH0pIHtcclxuICAgIHRoaXMuX2ltYWdlLnNyYyA9IGxpbms7XHJcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSBuYW1lO1xyXG4gICAgdGhpcy5fdGV4dC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJGb3JtVmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJmb3JtRWxlbWVudCIsImNvbmZpZyIsInRoaXMiLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2VFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImlkIiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsInJlbW92ZSIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2NoZWNrRm9ybVZhbGlkaXR5IiwiX2lucHV0RWxlbWVudHMiLCJldmVyeSIsImlucHV0IiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX3N1Ym1pdEJ1dHRvbiIsImRpc2FibGVkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwicmVzZXRWYWxpZGF0aW9uIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiQ2FyZCIsIl9yZWYiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlUHJldmlld0ltYWdlIiwiaGFuZGxlTGlrZUNhcmQiLCJjdXJyZW50VXNlcklkIiwiaGFuZGxlRGVsZXRlQ2FyZCIsIm93bmVyIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2lzTGlrZWQiLCJpc0xpa2VkIiwiX2lkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZUxpa2VDYXJkIiwiX2N1cnJlbnRVc2VySWQiLCJfb3duZXIiLCJfaGFuZGxlRGVsZXRlQ2FyZCIsImNvbnNvbGUiLCJsb2ciLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsImNvbnRlbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImNsb25lTm9kZSIsImRlbGV0ZUNsaWNrIiwiX2VsZW1lbnQiLCJ1cGRhdGVMaWtlcyIsInJlbmRlckxpa2VzIiwibGlrZUJ1dHRvbiIsIl9jaGVja0lkRm9yRGVsZXRlIiwiYWRkVHJhc2giLCJyZW1vdmVUcmFzaCIsImNhcmRUcmFzaEJ1dHRvbiIsImNhcmRJbWFnZSIsImdlbmVyYXRlQ2FyZCIsImNhcmRUaXRsZSIsInNyYyIsImFsdCIsIl9jYXJkTGlrZXMiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX21vZGFsU2F2ZUJ1dHRvbiIsIl9zYXZlQnV0dG9uVGV4dCIsIl9nZXRJbnB1dFZhbHVlIiwiaW5wdXRzIiwiaW5wdXRWYWx1ZXMiLCJ2YWx1ZSIsInJlbmRlckxvYWRpbmciLCJpc0xvYWRpbmciLCJyZXNldCIsIlNlY3Rpb24iLCJzZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwicHJvZmlsZU1vZGFsQm94IiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlRWRpdEZvcm0iLCJwcm9maWxlVGl0bGVJbnB1dCIsInByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwiYWRkTW9kYWxCb3giLCJhZGRNb2RhbEJ1dHRvbiIsImFkZE1vZGFsRm9ybSIsImF2aUZvcm0iLCJmb3JtVmFsaWRhdGlvbkNvbmZpZyIsInVzZXJJbmZvRWwiLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX25hbWVFbCIsIl9qb2JFbCIsIl9hdmF0YXJFbGVtZW50IiwiZ2V0VXNlckluZm8iLCJqb2IiLCJhdmF0YXIiLCJfYXZhdGFyRUxlbWVudCIsInNldEF2YXRhckluZm8iLCJzZXRVc2VySW5mbyIsIl9yZWYyIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZmV0Y2giLCJtZXRob2QiLCJ0aGVuIiwiZ2V0QXBwSW5mbyIsImFsbCIsImluaXRpYWxDYXJkcyIsImVkaXRQcm9maWxlIiwiZGVzY3JpcHRpb24iLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFib3V0IiwiYWRkTmV3Q2FyZCIsIl9yZWYzIiwiY2FyZExpa2VzIiwiY2FyZElkIiwiZGVsZXRlQ2FyZCIsImNhcmRJRCIsImFkZExpa2UiLCJyZW1vdmVMaWtlIiwidXBkYXRlUHJvZmlsZVBpY3R1cmUiLCJhdXRob3JpemF0aW9uIiwic2VjdGlvbkVsIiwiY3JlYXRlQ2FyZCIsImNhcmQiLCJpbWFnZVBvcHVwIiwic2hvdWxkUmVtb3ZlTGlrZSIsImNhdGNoIiwiZXJyIiwiZGVsZXRlUG9wdXAiLCJzZXRTdWJtaXRBY3Rpb24iLCJmaW5hbGx5IiwidXNlckRhdGEiLCJjYXJkRGF0YSIsImFkZEZvcm1WYWxpZGF0b3IiLCJwcm9maWxlRm9ybVZhbGlkYXRvciIsImF2aUZvcm1WYWxpZGF0b3IiLCJfY29uZmlybUJ1dHRvbiIsIl9zYXZlQnV0dG9uIiwiX2hhbmRsZURlbGV0ZVN1Ym1pdCIsImFjdGlvbiIsImVkaXRGb3JtTW9kYWwiLCJQb3B1cFdpdGhGb3JtIiwiYWRkRm9ybU1vZGFsIiwidXBkYXRlUHJvZmlsZUZvcm0iLCJfaW1hZ2UiLCJfdGV4dCJdLCJzb3VyY2VSb290IjoiIn0=